<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no, viewport-fit=cover" />
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
    <meta name="apple-mobile-web-app-title" content="CurlingPro" />
    <meta name="theme-color" content="#1a1a2e" />
    <link rel="manifest" href="/manifest.json" />
    <link rel="apple-touch-icon" href="/curlingpro.png" />
    <title>CurlingPro</title>
    <style>
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }
      button, [onclick], label {
        -webkit-user-select: none;
        -moz-user-select: none;
        -ms-user-select: none;
        user-select: none;
        -webkit-tap-highlight-color: transparent;
        -webkit-touch-callout: none;
      }
      body {
        overflow: hidden;
        background: #1a1a2e;
      }
      canvas {
        display: block;
      }
      #ui {
        position: fixed;
        top: max(20px, env(safe-area-inset-top));
        left: max(20px, env(safe-area-inset-left));
        color: white;
        font-family: 'Segoe UI', sans-serif;
        font-size: 16px;
        pointer-events: none;
        text-shadow: none;
      }
      #scoreboard {
        background: #222;
        border-radius: 6px;
        overflow: hidden;
        margin-bottom: 10px;
        box-shadow: 0 2px 8px rgba(0,0,0,0.5);
        border: 1px solid #444;
      }
      #score-table {
        border-collapse: collapse;
        font-size: 12px;
        font-weight: bold;
      }
      #score-table th, #score-table td {
        padding: 4px 8px;
        text-align: center;
        min-width: 24px;
        border: 1px solid #444;
      }
      #score-table thead th {
        background: #333;
        color: #aaa;
        font-weight: normal;
        font-size: 11px;
      }
      #score-table .team-col {
        min-width: 40px;
        font-weight: bold;
      }
      #score-table .team-red {
        background: #dc2626;
        color: white;
      }
      #score-table .team-yellow {
        background: #fbbf24;
        color: #333;
      }
      #score-table .hammer-col {
        min-width: 20px;
        background: #2a2a2a;
      }
      #score-table .total-col {
        min-width: 36px;
        background: #1a1a1a;
        font-size: 14px;
      }
      #score-table tbody td {
        background: #2d2d2d;
        color: #ccc;
      }
      #score-table tbody td.scored {
        font-weight: bold;
        color: white;
      }
      #score-table tbody td.scored-red {
        background: linear-gradient(135deg, #dc2626, #b91c1c);
        color: white;
      }
      #score-table tbody td.scored-yellow {
        background: linear-gradient(135deg, #fbbf24, #d97706);
        color: #333;
      }
      #score-table .hammer-indicator {
        color: #4ade80;
        font-size: 14px;
      }
      #score-table .current-end {
        box-shadow: inset 0 0 0 2px #4ade80;
      }
      #power-display {
        margin-top: 10px;
        padding: 10px;
        background: rgba(0,0,0,0.5);
        border-radius: 8px;
        display: none;
      }
      #phase-text {
        color: #4ade80;
        margin-bottom: 8px;
        font-weight: bold;
      }
      #power-bar {
        width: 200px;
        height: 20px;
        background: #333;
        border-radius: 4px;
        overflow: hidden;
        margin-top: 5px;
      }
      #power-fill {
        height: 100%;
        width: 0%;
        background: linear-gradient(90deg, #4ade80, #fbbf24, #ef4444);
        transition: width 0.05s;
      }
      #hold-warning {
        color: #fff;
        margin-top: 10px;
        display: none;
        font-weight: bold;
        font-size: 18px;
        padding: 12px 20px;
        background: linear-gradient(90deg, #dc2626, #ef4444);
        border-radius: 8px;
        animation: release-pulse 0.5s ease-in-out infinite;
        text-transform: uppercase;
        letter-spacing: 1px;
      }
      @keyframes release-pulse {
        0%, 100% {
          transform: scale(1);
          box-shadow: 0 0 10px rgba(239, 68, 68, 0.5);
        }
        50% {
          transform: scale(1.05);
          box-shadow: 0 0 25px rgba(239, 68, 68, 0.9);
        }
      }
      #curl-display {
        margin-top: 10px;
        padding: 10px;
      }
      #curl-direction {
        font-size: 14px;
      }
      .curl-slider-container {
        pointer-events: auto;
      }
      #curl-slider::-webkit-slider-thumb {
        -webkit-appearance: none;
        appearance: none;
        width: 28px;
        height: 28px;
        border-radius: 50%;
        background: #fff;
        border: 3px solid #333;
        cursor: pointer;
        box-shadow: 0 2px 6px rgba(0,0,0,0.3);
      }
      #curl-slider::-moz-range-thumb {
        width: 28px;
        height: 28px;
        border-radius: 50%;
        background: #fff;
        border: 3px solid #333;
        cursor: pointer;
        box-shadow: 0 2px 6px rgba(0,0,0,0.3);
      }
      @keyframes pulse-btn {
        0%, 100% { box-shadow: 0 0 5px rgba(245, 158, 11, 0.5); }
        50% { box-shadow: 0 0 15px rgba(245, 158, 11, 0.9); }
      }
      @keyframes pulse {
        0%, 100% { box-shadow: 0 0 5px rgba(74, 222, 128, 0.3); }
        50% { box-shadow: 0 0 15px rgba(74, 222, 128, 0.6); }
      }
      .curl-btn {
        padding: 8px 16px;
        border: 2px solid #666;
        background: #333;
        color: white;
        border-radius: 4px;
        cursor: pointer;
        font-size: 14px;
        transition: all 0.2s;
      }
      .curl-btn:hover {
        background: #444;
      }
      .curl-btn.active {
        border-color: #4ade80;
        background: #2d5a3d;
      }
      #instructions {
        position: fixed;
        bottom: max(20px, env(safe-area-inset-bottom));
        left: max(20px, env(safe-area-inset-left));
        color: white;
        font-family: 'Segoe UI', sans-serif;
        font-size: 14px;
        background: rgba(0,0,0,0.5);
        padding: 15px;
        padding-top: 25px;
        border-radius: 8px;
        pointer-events: auto;
        line-height: 1.6;
      }
      #sweep-indicator {
        position: fixed;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        color: #4ade80;
        font-size: 32px;
        font-weight: bold;
        text-shadow: 2px 2px 4px rgba(0,0,0,0.8);
        display: none;
        pointer-events: none;
      }
      #marker-hint {
        position: fixed;
        bottom: 120px;
        left: 50%;
        transform: translateX(-50%);
        background: rgba(0, 0, 0, 0.8);
        color: #fbbf24;
        font-family: 'Segoe UI', system-ui, sans-serif;
        font-size: 16px;
        font-weight: 500;
        padding: 12px 24px;
        border-radius: 30px;
        border: 2px solid #fbbf24;
        display: none;
        pointer-events: none;
        z-index: 100;
        animation: pulse-hint 2s ease-in-out infinite;
        text-align: center;
      }
      @keyframes pulse-hint {
        0%, 100% { opacity: 0.9; transform: translateX(-50%) scale(1); }
        50% { opacity: 1; transform: translateX(-50%) scale(1.02); }
      }
      /* Score announcement overlay */
      #score-overlay {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(0, 0, 0, 0.85);
        display: none;
        justify-content: center;
        align-items: center;
        z-index: 1000;
        opacity: 0;
        transition: opacity 0.5s ease;
      }
      #score-overlay.visible {
        opacity: 1;
      }
      #score-card {
        background: linear-gradient(135deg, #1e293b 0%, #0f172a 100%);
        border-radius: 20px;
        padding: 40px 60px;
        text-align: center;
        box-shadow: 0 25px 50px rgba(0, 0, 0, 0.5), 0 0 100px rgba(74, 222, 128, 0.1);
        transform: scale(0.8);
        transition: transform 0.5s cubic-bezier(0.34, 1.56, 0.64, 1);
        border: 2px solid #334155;
      }
      #score-overlay.visible #score-card {
        transform: scale(1);
      }
      #score-card h2 {
        font-size: 18px;
        color: #94a3b8;
        margin-bottom: 10px;
        text-transform: uppercase;
        letter-spacing: 3px;
      }
      #score-team {
        font-size: 48px;
        font-weight: bold;
        margin: 15px 0;
        text-transform: uppercase;
        text-shadow: 0 4px 20px currentColor;
      }
      #score-team.red { color: #ef4444; }
      #score-team.yellow { color: #fbbf24; }
      #score-team.blank { color: #64748b; }
      #score-points {
        font-size: 120px;
        font-weight: bold;
        color: white;
        line-height: 1;
        margin: 20px 0;
        text-shadow: 0 0 40px rgba(255, 255, 255, 0.3);
      }
      #score-points-label {
        font-size: 24px;
        color: #94a3b8;
        margin-bottom: 20px;
      }
      #score-totals {
        display: flex;
        justify-content: center;
        gap: 40px;
        margin-top: 30px;
        padding-top: 30px;
        border-top: 1px solid #334155;
      }
      .score-total {
        text-align: center;
      }
      .score-total-label {
        font-size: 14px;
        color: #64748b;
        text-transform: uppercase;
        letter-spacing: 2px;
        margin-bottom: 5px;
      }
      .score-total-value {
        font-size: 36px;
        font-weight: bold;
      }
      .score-total-value.red { color: #ef4444; }
      .score-total-value.yellow { color: #fbbf24; }
      #score-continue {
        margin-top: 30px;
        padding: 15px 40px;
        font-size: 16px;
        font-weight: bold;
        background: linear-gradient(135deg, #4ade80 0%, #22c55e 100%);
        color: #000;
        border: none;
        border-radius: 8px;
        cursor: pointer;
        text-transform: uppercase;
        letter-spacing: 2px;
        transition: transform 0.2s, box-shadow 0.2s;
      }
      #score-continue:hover {
        transform: translateY(-2px);
        box-shadow: 0 10px 30px rgba(74, 222, 128, 0.3);
      }
      #score-stones-display {
        display: flex;
        justify-content: center;
        gap: 8px;
        margin: 20px 0;
      }
      .score-stone {
        width: 24px;
        height: 24px;
        border-radius: 50%;
        border: 2px solid rgba(255,255,255,0.3);
        animation: stonePop 0.3s ease backwards;
      }
      .score-stone.red { background: #ef4444; border-color: #fca5a5; }
      .score-stone.yellow { background: #fbbf24; border-color: #fde68a; }
      @keyframes stonePop {
        from { transform: scale(0); opacity: 0; }
        to { transform: scale(1); opacity: 1; }
      }
      /* Game Over overlay */
      #gameover-overlay {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(0, 0, 0, 0.9);
        display: none;
        justify-content: center;
        align-items: center;
        z-index: 1000;
        opacity: 0;
        transition: opacity 0.5s ease;
      }
      #gameover-overlay.visible {
        opacity: 1;
      }
      #gameover-card {
        background: linear-gradient(135deg, #1e293b 0%, #0f172a 100%);
        border-radius: 20px;
        padding: 50px 80px;
        text-align: center;
        box-shadow: 0 25px 50px rgba(0, 0, 0, 0.5);
        transform: scale(0.8);
        transition: transform 0.5s cubic-bezier(0.34, 1.56, 0.64, 1);
        border: 3px solid #4ade80;
      }
      #gameover-overlay.visible #gameover-card {
        transform: scale(1);
      }
      #gameover-title {
        font-size: 24px;
        color: #94a3b8;
        margin-bottom: 20px;
        text-transform: uppercase;
        letter-spacing: 4px;
      }
      #gameover-winner {
        font-size: 56px;
        font-weight: bold;
        margin: 20px 0;
        text-transform: uppercase;
        text-shadow: 0 4px 30px currentColor;
      }
      #gameover-winner.red { color: #ef4444; }
      #gameover-winner.yellow { color: #fbbf24; }
      #gameover-winner.tie { color: #a78bfa; }
      #gameover-subtitle {
        font-size: 28px;
        color: white;
        margin-bottom: 30px;
      }
      #gameover-final-scores {
        display: flex;
        justify-content: center;
        gap: 60px;
        margin: 30px 0;
      }
      .final-score {
        text-align: center;
      }
      .final-score-label {
        font-size: 16px;
        color: #64748b;
        text-transform: uppercase;
        letter-spacing: 2px;
        margin-bottom: 10px;
      }
      .final-score-value {
        font-size: 64px;
        font-weight: bold;
      }
      .final-score-value.red { color: #ef4444; }
      .final-score-value.yellow { color: #fbbf24; }
      #gameover-restart {
        margin-top: 30px;
        padding: 18px 50px;
        font-size: 18px;
        font-weight: bold;
        background: linear-gradient(135deg, #4ade80 0%, #22c55e 100%);
        color: #000;
        border: none;
        border-radius: 8px;
        cursor: pointer;
        text-transform: uppercase;
        letter-spacing: 2px;
        transition: transform 0.2s, box-shadow 0.2s;
      }
      #gameover-restart:hover {
        transform: translateY(-2px);
        box-shadow: 0 10px 30px rgba(74, 222, 128, 0.3);
      }

      /* Shot Feedback Toast - Sports Broadcast Style */
      .shot-feedback-toast {
        position: fixed;
        top: 32%;
        left: 50%;
        transform: translate(-50%, -50%) scale(0.8);
        padding: 0;
        background: transparent;
        font-family: 'Segoe UI', system-ui, sans-serif;
        font-size: 42px;
        font-weight: 900;
        font-style: italic;
        text-align: center;
        z-index: 800;
        pointer-events: none;
        opacity: 0;
        display: none;
        text-transform: uppercase;
        letter-spacing: 3px;
        -webkit-text-stroke: 2px rgba(0, 0, 0, 0.5);
        paint-order: stroke fill;
      }
      .shot-feedback-toast.success {
        color: #4ade80;
        text-shadow:
          0 0 10px #4ade80,
          0 0 20px #4ade80,
          0 0 40px #22c55e,
          0 0 60px #22c55e,
          0 4px 8px rgba(0, 0, 0, 0.5);
        animation: toast-glow-green 0.5s ease-out forwards;
      }
      .shot-feedback-toast.near-miss {
        color: #fbbf24;
        text-shadow:
          0 0 10px #fbbf24,
          0 0 20px #fbbf24,
          0 0 40px #f59e0b,
          0 0 60px #d97706,
          0 4px 8px rgba(0, 0, 0, 0.5);
        animation: toast-glow-orange 0.5s ease-out forwards;
      }
      @keyframes toast-glow-green {
        0% {
          transform: translate(-50%, -50%) scale(0.3) rotate(-5deg);
          opacity: 0;
          filter: blur(10px);
        }
        50% {
          transform: translate(-50%, -50%) scale(1.15) rotate(0deg);
          filter: blur(0);
        }
        100% {
          transform: translate(-50%, -50%) scale(1) rotate(0deg);
          opacity: 1;
          filter: blur(0);
        }
      }
      @keyframes toast-glow-orange {
        0% {
          transform: translate(-50%, -50%) scale(0.3) rotate(-5deg);
          opacity: 0;
          filter: blur(10px);
        }
        50% {
          transform: translate(-50%, -50%) scale(1.15) rotate(0deg);
          filter: blur(0);
        }
        100% {
          transform: translate(-50%, -50%) scale(1) rotate(0deg);
          opacity: 1;
          filter: blur(0);
        }
      }
      @keyframes toast-pop {
        0% { transform: translate(-50%, -50%) scale(0.5); opacity: 0; }
        50% { transform: translate(-50%, -50%) scale(1.1); }
        100% { transform: translate(-50%, -50%) scale(1); opacity: 1; }
      }

      /* Marker reminder animations */
      @keyframes marker-reminder-enter {
        0% {
          transform: translateX(-50%) translateY(-30px) scale(0.8);
          opacity: 0;
        }
        100% {
          transform: translateX(-50%) translateY(0) scale(1);
          opacity: 1;
        }
      }
      @keyframes marker-reminder-pulse {
        0%, 100% { transform: translateX(-50%) scale(1); }
        50% { transform: translateX(-50%) scale(1.05); }
      }
    </style>
  </head>
  <body>
    <!-- Shot Feedback Toast -->
    <div id="shot-feedback-toast" class="shot-feedback-toast"></div>

    <!-- Splash Screen -->
    <div id="splash-screen" style="
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: linear-gradient(135deg, #0d1117 0%, #1a1a2e 50%, #16213e 100%);
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      z-index: 10000;
      transition: opacity 0.5s ease;
    ">
      <div style="text-align: center;">
        <img src="/curlingpro.png" alt="CurlingPro" style="
          width: 150px;
          height: auto;
          margin-bottom: 20px;
          filter: drop-shadow(0 4px 20px rgba(74, 222, 128, 0.3));
        ">
        <h1 style="
          font-family: 'Segoe UI', system-ui, sans-serif;
          font-size: 48px;
          font-weight: bold;
          color: white;
          margin: 0 0 10px 0;
          text-shadow: 0 4px 20px rgba(74, 222, 128, 0.3);
        ">CurlingPro</h1>
        <p style="
          font-family: 'Segoe UI', system-ui, sans-serif;
          font-size: 18px;
          color: #94a3b8;
          margin: 0 0 40px 0;
        ">The Ultimate Curling Experience</p>
        <div id="loading-bar" style="
          width: 200px;
          height: 4px;
          background: #333;
          border-radius: 2px;
          overflow: hidden;
          margin: 0 auto 20px auto;
        ">
          <div id="loading-progress" style="
            width: 0%;
            height: 100%;
            background: linear-gradient(90deg, #4ade80, #22c55e);
            transition: width 0.3s ease;
          "></div>
        </div>
        <p id="loading-text" style="
          font-family: 'Segoe UI', system-ui, sans-serif;
          font-size: 14px;
          color: #64748b;
        ">Loading...</p>
      </div>
      <div style="
        position: absolute;
        bottom: 30px;
        font-family: 'Segoe UI', system-ui, sans-serif;
        font-size: 12px;
        color: #475569;
      ">v1.0.0</div>
    </div>

    <!-- Mode Selection Screen -->
    <div id="mode-select-screen" style="
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: linear-gradient(135deg, #0d1117 0%, #1a1a2e 50%, #16213e 100%);
      z-index: 9000;
      overflow-y: auto;
    ">
      <!-- Footer links -->
      <div style="
        position: absolute;
        bottom: max(30px, env(safe-area-inset-bottom));
        left: 50%;
        transform: translateX(-50%);
        display: flex;
        gap: 20px;
        z-index: 100;
        font-family: 'Segoe UI', system-ui, sans-serif;
      ">
        <button onclick="window.showAbout(false)" style="
          padding: 8px 12px;
          background: transparent;
          border: none;
          color: #64748b;
          font-size: 12px;
          cursor: pointer;
        ">About</button>
        <button onclick="window.showPrivacyPolicy()" style="
          padding: 8px 12px;
          background: transparent;
          border: none;
          color: #64748b;
          font-size: 12px;
          cursor: pointer;
        ">Privacy</button>
        <button onclick="window.showTermsOfService()" style="
          padding: 8px 12px;
          background: transparent;
          border: none;
          color: #64748b;
          font-size: 12px;
          cursor: pointer;
        ">Terms</button>
      </div>

      <div style="
        max-width: 400px;
        margin: 0 auto;
        padding: 60px 20px;
        font-family: 'Segoe UI', system-ui, sans-serif;
        text-align: center;
      ">
        <img src="/curlingpro.png" alt="CurlingPro" style="
          width: 100px;
          height: auto;
          margin-bottom: 20px;
          filter: drop-shadow(0 4px 20px rgba(74, 222, 128, 0.3));
        ">
        <h1 style="
          color: white;
          font-size: 32px;
          margin-bottom: 40px;
        ">Select Game Mode</h1>

        <button onclick="window.selectMode('career')" style="
          width: 100%;
          padding: 20px;
          margin-bottom: 12px;
          background: linear-gradient(135deg, #1a4d2e 0%, #2d6b40 100%);
          border: 2px solid #4ade80;
          border-radius: 12px;
          cursor: pointer;
          transition: transform 0.2s, box-shadow 0.2s;
          text-align: left;
        ">
          <div style="color: white; font-size: 18px; font-weight: bold;">üèÜ Career Mode</div>
          <div style="color: #86efac; font-size: 13px; margin-top: 4px;">Start at Club level and work your way to the Olympics</div>
        </button>

        <button onclick="window.selectMode('quickplay')" style="
          width: 100%;
          padding: 20px;
          margin-bottom: 12px;
          background: linear-gradient(135deg, #1e3a5f 0%, #2d5a7b 100%);
          border: 2px solid #4a90c2;
          border-radius: 12px;
          cursor: pointer;
          transition: transform 0.2s, box-shadow 0.2s;
          text-align: left;
        ">
          <div style="color: white; font-size: 18px; font-weight: bold;">üéÆ Quick Play</div>
          <div style="color: #93c5fd; font-size: 13px; margin-top: 4px;">Jump into a game at any difficulty level</div>
        </button>

        <button onclick="window.selectMode('practice')" style="
          width: 100%;
          padding: 20px;
          margin-bottom: 12px;
          background: linear-gradient(135deg, #4c1d95 0%, #6d28d9 100%);
          border: 2px solid #a78bfa;
          border-radius: 12px;
          cursor: pointer;
          transition: transform 0.2s, box-shadow 0.2s;
          text-align: left;
        ">
          <div style="color: white; font-size: 18px; font-weight: bold;">üéØ Practice Mode</div>
          <div style="color: #c4b5fd; font-size: 13px; margin-top: 4px;">Master shot types with focused drills</div>
        </button>

        <button id="online-mode-btn" onclick="window.selectMode('online')" style="
          width: 100%;
          padding: 20px;
          margin-bottom: 12px;
          background: linear-gradient(135deg, #7c2d12 0%, #c2410c 100%);
          border: 2px solid #fb923c;
          border-radius: 12px;
          cursor: pointer;
          transition: transform 0.2s, box-shadow 0.2s;
          text-align: left;
        ">
          <div style="color: white; font-size: 18px; font-weight: bold;">üåê Online Multiplayer</div>
          <div style="color: #fed7aa; font-size: 13px; margin-top: 4px;">Challenge a friend over the internet</div>
        </button>

        <!-- Stats & Leaderboard buttons -->
        <div style="display: flex; gap: 12px; margin-top: 20px;">
          <button onclick="window.showLeaderboard()" style="
            flex: 1;
            padding: 16px;
            background: linear-gradient(135deg, rgba(251, 191, 36, 0.15) 0%, rgba(251, 191, 36, 0.25) 100%);
            border: 1px solid rgba(251, 191, 36, 0.5);
            border-radius: 10px;
            cursor: pointer;
            transition: transform 0.2s, box-shadow 0.2s;
            text-align: center;
          ">
            <div style="color: #fbbf24; font-size: 22px; margin-bottom: 4px;">üèÖ</div>
            <div style="color: white; font-size: 14px; font-weight: bold;">Leaderboard</div>
          </button>
          <button onclick="window.showStats()" style="
            flex: 1;
            padding: 16px;
            background: linear-gradient(135deg, rgba(139, 92, 246, 0.15) 0%, rgba(139, 92, 246, 0.25) 100%);
            border: 1px solid rgba(139, 92, 246, 0.5);
            border-radius: 10px;
            cursor: pointer;
            transition: transform 0.2s, box-shadow 0.2s;
            text-align: center;
          ">
            <div style="color: #a78bfa; font-size: 22px; margin-bottom: 4px;">üìä</div>
            <div style="color: white; font-size: 14px; font-weight: bold;">My Stats</div>
          </button>
        </div>
      </div>
    </div>

    <!-- Practice Drill Selection Screen -->
    <div id="practice-drill-screen" style="
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: linear-gradient(135deg, #0d1117 0%, #1a1a2e 50%, #16213e 100%);
      z-index: 9000;
      overflow-y: auto;
    ">
      <div style="
        max-width: 500px;
        margin: 0 auto;
        padding: 40px 20px max(100px, calc(40px + env(safe-area-inset-bottom)));
        font-family: 'Segoe UI', system-ui, sans-serif;
      ">
        <!-- Header -->
        <div style="display: flex; align-items: center; gap: 16px; margin-bottom: 32px;">
          <button onclick="window.showModeSelect()" style="
            background: rgba(255, 255, 255, 0.1);
            border: none;
            border-radius: 8px;
            color: white;
            font-size: 20px;
            padding: 8px 12px;
            cursor: pointer;
          ">‚Üê</button>
          <h1 style="color: white; font-size: 28px; margin: 0;">Practice Mode</h1>
        </div>

        <p style="color: #94a3b8; font-size: 14px; margin-bottom: 24px;">
          Select a shot type to practice. Master each drill to improve your game.
        </p>

        <!-- Drill Grid -->
        <div id="practice-drill-grid" style="
          display: grid;
          grid-template-columns: repeat(2, 1fr);
          gap: 12px;
        ">
          <!-- Drill cards populated dynamically -->
        </div>
      </div>
    </div>

    <!-- Practice Scenario Selection Screen -->
    <div id="practice-scenario-screen" style="
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: linear-gradient(135deg, #0d1117 0%, #1a1a2e 50%, #16213e 100%);
      z-index: 9000;
      overflow-y: auto;
    ">
      <div style="
        max-width: 500px;
        margin: 0 auto;
        padding: 40px 20px max(100px, calc(40px + env(safe-area-inset-bottom)));
        font-family: 'Segoe UI', system-ui, sans-serif;
      ">
        <!-- Header -->
        <div style="display: flex; align-items: center; gap: 16px; margin-bottom: 24px;">
          <button onclick="window.showPracticeDrills()" style="
            background: rgba(255, 255, 255, 0.1);
            border: none;
            border-radius: 8px;
            color: white;
            font-size: 20px;
            padding: 8px 12px;
            cursor: pointer;
          ">‚Üê</button>
          <div>
            <h1 id="scenario-drill-title" style="color: white; font-size: 24px; margin: 0;">Takeouts</h1>
            <p id="scenario-drill-desc" style="color: #94a3b8; font-size: 13px; margin: 4px 0 0 0;">Remove opponent stones</p>
          </div>
        </div>

        <!-- Drill Stats -->
        <div style="
          background: rgba(255, 255, 255, 0.05);
          border-radius: 12px;
          padding: 16px;
          margin-bottom: 20px;
          display: flex;
          justify-content: space-around;
          text-align: center;
        ">
          <div>
            <div id="drill-success-rate" style="color: #4ade80; font-size: 24px; font-weight: bold;">0%</div>
            <div style="color: #64748b; font-size: 12px;">Success Rate</div>
          </div>
          <div style="width: 1px; background: rgba(255,255,255,0.1);"></div>
          <div>
            <div id="drill-attempts" style="color: white; font-size: 24px; font-weight: bold;">0</div>
            <div style="color: #64748b; font-size: 12px;">Attempts</div>
          </div>
          <div style="width: 1px; background: rgba(255,255,255,0.1);"></div>
          <div>
            <div id="drill-unlocked" style="color: #a78bfa; font-size: 24px; font-weight: bold;">1/5</div>
            <div style="color: #64748b; font-size: 12px;">Unlocked</div>
          </div>
        </div>

        <!-- Scenario List -->
        <div id="practice-scenario-list">
          <!-- Scenarios populated dynamically -->
        </div>
      </div>
    </div>

    <style>
      .practice-drill-card {
        background: rgba(255, 255, 255, 0.05);
        border: 2px solid rgba(255, 255, 255, 0.1);
        border-radius: 16px;
        padding: 20px;
        cursor: pointer;
        transition: all 0.2s;
        text-align: center;
      }
      .practice-drill-card:hover {
        background: rgba(255, 255, 255, 0.08);
        border-color: #a78bfa;
        transform: translateY(-2px);
      }
      .practice-drill-card:active {
        transform: scale(0.98);
      }
      .practice-drill-icon {
        font-size: 36px;
        margin-bottom: 8px;
      }
      .practice-drill-name {
        color: white;
        font-size: 16px;
        font-weight: bold;
        margin-bottom: 4px;
      }
      .practice-drill-rate {
        color: #4ade80;
        font-size: 14px;
        font-weight: 500;
      }
      .practice-drill-rate.no-data {
        color: #64748b;
      }

      .practice-scenario-card {
        background: rgba(255, 255, 255, 0.05);
        border: 2px solid rgba(255, 255, 255, 0.1);
        border-radius: 12px;
        padding: 16px;
        margin-bottom: 10px;
        cursor: pointer;
        transition: all 0.2s;
      }
      .practice-scenario-card:hover {
        background: rgba(255, 255, 255, 0.08);
        border-color: rgba(255, 255, 255, 0.2);
      }
      .practice-scenario-card.locked {
        opacity: 0.5;
        cursor: not-allowed;
      }
      .practice-scenario-card.locked:hover {
        background: rgba(255, 255, 255, 0.05);
        border-color: rgba(255, 255, 255, 0.1);
      }
      .scenario-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 6px;
      }
      .scenario-name {
        color: white;
        font-size: 16px;
        font-weight: 600;
      }
      .scenario-difficulty {
        display: flex;
        gap: 3px;
      }
      .scenario-difficulty .dot {
        width: 8px;
        height: 8px;
        border-radius: 50%;
        background: #334155;
      }
      .scenario-difficulty .dot.filled {
        background: #a78bfa;
      }
      .scenario-description {
        color: #94a3b8;
        font-size: 13px;
        margin-bottom: 8px;
      }
      .scenario-stats {
        display: flex;
        justify-content: space-between;
        align-items: center;
      }
      .scenario-best {
        color: #64748b;
        font-size: 12px;
      }
      .scenario-start-btn {
        background: linear-gradient(135deg, #6d28d9 0%, #7c3aed 100%);
        border: none;
        border-radius: 6px;
        color: white;
        font-size: 12px;
        font-weight: 600;
        padding: 6px 14px;
        cursor: pointer;
      }
      .scenario-lock {
        color: #64748b;
        font-size: 12px;
        display: flex;
        align-items: center;
        gap: 6px;
      }
    </style>

    <!-- Multiplayer Lobby Screen -->
    <div id="multiplayer-lobby-screen" style="
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: linear-gradient(135deg, #0d1117 0%, #1a1a2e 50%, #16213e 100%);
      z-index: 9000;
      overflow-y: auto;
    ">
      <div style="
        max-width: 400px;
        margin: 0 auto;
        padding: 60px 20px;
        font-family: 'Segoe UI', system-ui, sans-serif;
        text-align: center;
      ">
        <div style="font-size: 48px; margin-bottom: 16px;">üåê</div>
        <h1 style="color: white; font-size: 28px; margin-bottom: 8px;">Online Multiplayer</h1>
        <p style="color: #94a3b8; font-size: 14px; margin-bottom: 24px;">Play against others online</p>

        <!-- Player Name Input -->
        <div style="margin-bottom: 24px; text-align: left;">
          <label style="color: #94a3b8; font-size: 12px; display: block; margin-bottom: 6px;">YOUR NAME</label>
          <input type="text" id="mp-player-name" placeholder="Enter your name" maxlength="20" style="
            width: 100%;
            padding: 14px 16px;
            background: rgba(255, 255, 255, 0.05);
            border: 2px solid rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            color: white;
            font-size: 16px;
            box-sizing: border-box;
          ">
        </div>

        <!-- Quick Match Button (Ranked) -->
        <button id="quick-match-btn" onclick="window.startQuickMatch()" style="
          width: 100%;
          padding: 18px;
          margin-bottom: 16px;
          background: linear-gradient(135deg, #4ade80 0%, #22c55e 100%);
          border: none;
          border-radius: 12px;
          cursor: pointer;
          transition: transform 0.2s, box-shadow 0.2s;
          color: white;
          font-size: 18px;
          font-weight: bold;
          box-shadow: 0 4px 20px rgba(74, 222, 128, 0.3);
        ">
          <div style="display: flex; align-items: center; justify-content: center; gap: 10px;">
            <span>Quick Match</span>
            <span style="font-size: 12px; opacity: 0.8; background: rgba(0,0,0,0.2); padding: 2px 8px; border-radius: 10px;">RANKED</span>
          </div>
        </button>

        <!-- Player ELO display -->
        <div id="player-elo-display" style="
          color: #94a3b8;
          font-size: 13px;
          margin-bottom: 24px;
          display: none;
        ">
          Your Rating: <span id="player-elo-value" style="color: #fbbf24; font-weight: bold;">1000</span>
          <span id="player-record" style="margin-left: 8px; opacity: 0.7;"></span>
        </div>

        <div style="color: #64748b; font-size: 13px; margin: 16px 0;">‚Äî or play with a friend ‚Äî</div>

        <!-- Create Game Button -->
        <button onclick="window.createOnlineGame()" style="
          width: 100%;
          padding: 18px;
          margin-bottom: 12px;
          background: linear-gradient(135deg, #7c2d12 0%, #c2410c 100%);
          border: 2px solid #fb923c;
          border-radius: 12px;
          cursor: pointer;
          transition: transform 0.2s, box-shadow 0.2s;
          color: white;
          font-size: 16px;
          font-weight: bold;
        ">Create Game</button>

        <div style="color: #64748b; font-size: 13px; margin: 16px 0;">‚Äî or ‚Äî</div>

        <!-- Join Game Section -->
        <div style="text-align: left; margin-bottom: 12px;">
          <label style="color: #94a3b8; font-size: 12px; display: block; margin-bottom: 6px;">ROOM CODE</label>
          <input type="text" id="mp-room-code" placeholder="Enter 6-letter code" maxlength="6" style="
            width: 100%;
            padding: 14px 16px;
            background: rgba(255, 255, 255, 0.05);
            border: 2px solid rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            color: white;
            font-size: 18px;
            font-family: monospace;
            text-transform: uppercase;
            letter-spacing: 4px;
            text-align: center;
            box-sizing: border-box;
          ">
        </div>

        <button onclick="window.joinOnlineGame()" style="
          width: 100%;
          padding: 18px;
          margin-bottom: 24px;
          background: rgba(255, 255, 255, 0.05);
          border: 2px solid rgba(255, 255, 255, 0.2);
          border-radius: 12px;
          cursor: pointer;
          transition: transform 0.2s, box-shadow 0.2s;
          color: white;
          font-size: 16px;
          font-weight: bold;
        ">Join Game</button>

        <!-- Error message -->
        <div id="mp-error" style="
          display: none;
          color: #f87171;
          background: rgba(248, 113, 113, 0.1);
          border: 1px solid rgba(248, 113, 113, 0.3);
          border-radius: 8px;
          padding: 12px;
          margin-bottom: 16px;
          font-size: 14px;
        "></div>

        <button onclick="window.showModeSelect()" style="
          padding: 12px 24px;
          background: transparent;
          border: 1px solid #64748b;
          border-radius: 8px;
          color: #94a3b8;
          font-size: 14px;
          cursor: pointer;
        ">Back to Menu</button>
      </div>
    </div>

    <!-- Multiplayer Waiting Screen -->
    <div id="multiplayer-waiting-screen" style="
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: linear-gradient(135deg, #0d1117 0%, #1a1a2e 50%, #16213e 100%);
      z-index: 9000;
      overflow-y: auto;
    ">
      <div style="
        max-width: 400px;
        margin: 0 auto;
        padding: 60px 20px;
        font-family: 'Segoe UI', system-ui, sans-serif;
        text-align: center;
      ">
        <div id="mp-waiting-spinner" style="
          width: 60px;
          height: 60px;
          border: 4px solid rgba(251, 146, 60, 0.2);
          border-top-color: #fb923c;
          border-radius: 50%;
          margin: 0 auto 24px;
          animation: spin 1s linear infinite;
        "></div>

        <h2 id="mp-waiting-title" style="color: white; font-size: 24px; margin-bottom: 12px;">
          Waiting for opponent...
        </h2>

        <p id="mp-waiting-subtitle" style="color: #94a3b8; font-size: 14px; margin-bottom: 32px;">
          Share the room code with your friend
        </p>

        <!-- Room Code Display -->
        <div id="mp-room-code-display" style="
          background: rgba(251, 146, 60, 0.1);
          border: 2px solid #fb923c;
          border-radius: 16px;
          padding: 24px;
          margin-bottom: 32px;
        ">
          <div style="color: #94a3b8; font-size: 12px; margin-bottom: 8px;">ROOM CODE</div>
          <div id="mp-room-code-value" style="
            color: white;
            font-size: 36px;
            font-family: monospace;
            font-weight: bold;
            letter-spacing: 6px;
          ">------</div>
          <button onclick="window.copyRoomCode()" style="
            margin-top: 12px;
            padding: 8px 16px;
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 6px;
            color: #94a3b8;
            font-size: 13px;
            cursor: pointer;
          ">Copy Code</button>
        </div>

        <!-- Opponent Info (shown when connected) -->
        <div id="mp-opponent-info" style="
          display: none;
          background: rgba(74, 222, 128, 0.1);
          border: 2px solid #4ade80;
          border-radius: 12px;
          padding: 16px;
          margin-bottom: 24px;
        ">
          <div style="color: #4ade80; font-size: 14px; margin-bottom: 4px;">Opponent Connected!</div>
          <div id="mp-opponent-name" style="color: white; font-size: 18px; font-weight: bold;"></div>
        </div>

        <!-- Start Game Button (host only, shown when opponent connects) -->
        <button id="mp-start-game-btn" onclick="window.startOnlineGame()" style="
          display: none;
          width: 100%;
          padding: 18px;
          margin-bottom: 16px;
          background: linear-gradient(135deg, #166534 0%, #22c55e 100%);
          border: 2px solid #4ade80;
          border-radius: 12px;
          cursor: pointer;
          color: white;
          font-size: 18px;
          font-weight: bold;
        ">Start Game</button>

        <button onclick="window.cancelOnlineGame()" style="
          padding: 12px 24px;
          background: transparent;
          border: 1px solid #64748b;
          border-radius: 8px;
          color: #94a3b8;
          font-size: 14px;
          cursor: pointer;
        ">Cancel</button>
      </div>
    </div>

    <style>
      @keyframes spin {
        to { transform: rotate(360deg); }
      }
      #mp-player-name:focus,
      #mp-room-code:focus {
        outline: none;
        border-color: #fb923c;
      }
      @keyframes pulse-glow {
        0%, 100% { box-shadow: 0 0 20px rgba(74, 222, 128, 0.3); }
        50% { box-shadow: 0 0 40px rgba(74, 222, 128, 0.6); }
      }
      @keyframes search-dots {
        0%, 20% { content: '.'; }
        40% { content: '..'; }
        60%, 100% { content: '...'; }
      }
    </style>

    <!-- Quick Match Searching Screen -->
    <div id="quickmatch-searching-screen" style="
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: linear-gradient(135deg, #0d1117 0%, #1a1a2e 50%, #16213e 100%);
      z-index: 9000;
      overflow-y: auto;
    ">
      <div style="
        max-width: 400px;
        margin: 0 auto;
        padding: 60px 20px;
        font-family: 'Segoe UI', system-ui, sans-serif;
        text-align: center;
      ">
        <!-- Animated Search Ring -->
        <div style="
          width: 100px;
          height: 100px;
          border: 4px solid rgba(74, 222, 128, 0.2);
          border-top-color: #4ade80;
          border-radius: 50%;
          margin: 0 auto 32px;
          animation: spin 1s linear infinite, pulse-glow 2s ease-in-out infinite;
          display: flex;
          align-items: center;
          justify-content: center;
        ">
          <span style="font-size: 36px;">üéØ</span>
        </div>

        <h2 id="qm-status-title" style="color: white; font-size: 22px; margin-bottom: 12px;">
          Finding opponent...
        </h2>

        <p id="qm-status-message" style="color: #94a3b8; font-size: 14px; margin-bottom: 8px;">
          Finding opponent near your skill level...
        </p>

        <p id="qm-wait-time" style="color: #64748b; font-size: 13px; margin-bottom: 32px;">
          0s
        </p>

        <!-- Player Rating Info -->
        <div style="
          background: rgba(74, 222, 128, 0.1);
          border: 1px solid rgba(74, 222, 128, 0.3);
          border-radius: 12px;
          padding: 16px;
          margin-bottom: 32px;
        ">
          <div style="color: #94a3b8; font-size: 12px; margin-bottom: 4px;">YOUR RATING</div>
          <div id="qm-player-elo" style="color: #4ade80; font-size: 28px; font-weight: bold;">1000</div>
          <div id="qm-search-range" style="color: #64748b; font-size: 12px; margin-top: 4px;">
            Searching: ¬±200 ELO
          </div>
        </div>

        <!-- Match Found Animation (hidden initially) -->
        <div id="qm-match-found" style="
          display: none;
          background: rgba(74, 222, 128, 0.15);
          border: 2px solid #4ade80;
          border-radius: 12px;
          padding: 20px;
          margin-bottom: 24px;
        ">
          <div style="font-size: 32px; margin-bottom: 8px;">üéÆ</div>
          <div style="color: #4ade80; font-size: 18px; font-weight: bold; margin-bottom: 4px;">Match Found!</div>
          <div id="qm-opponent-name" style="color: white; font-size: 16px;"></div>
          <div id="qm-opponent-elo" style="color: #94a3b8; font-size: 13px;"></div>
        </div>

        <button onclick="window.cancelQuickMatch()" style="
          padding: 14px 32px;
          background: transparent;
          border: 1px solid #64748b;
          border-radius: 8px;
          color: #94a3b8;
          font-size: 14px;
          cursor: pointer;
        ">Cancel Search</button>
      </div>
    </div>

    <!-- Difficulty Selection Screen -->
    <div id="difficulty-select-screen" style="
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: linear-gradient(135deg, #0d1117 0%, #1a1a2e 50%, #16213e 100%);
      z-index: 9000;
      overflow-y: auto;
    ">
      <div style="
        max-width: 400px;
        margin: 0 auto;
        padding: 60px 20px;
        font-family: 'Segoe UI', system-ui, sans-serif;
        text-align: center;
      ">
        <h1 style="
          color: white;
          font-size: 32px;
          margin-bottom: 40px;
        ">Select Difficulty</h1>

        <button onclick="window.selectDifficulty('easy')" style="
          width: 100%;
          padding: 20px;
          margin-bottom: 12px;
          background: linear-gradient(135deg, #1a4d2e 0%, #2d6b40 100%);
          border: 2px solid #4ade80;
          border-radius: 12px;
          cursor: pointer;
          transition: transform 0.2s, box-shadow 0.2s;
        ">
          <div style="color: white; font-size: 18px; font-weight: bold;">üå± Easy</div>
          <div style="color: #86efac; font-size: 13px; margin-top: 4px;">More forgiving throws, helpful hints</div>
        </button>

        <button onclick="window.selectDifficulty('medium')" style="
          width: 100%;
          padding: 20px;
          margin-bottom: 12px;
          background: linear-gradient(135deg, #4d3d1a 0%, #6b5a2d 100%);
          border: 2px solid #fbbf24;
          border-radius: 12px;
          cursor: pointer;
          transition: transform 0.2s, box-shadow 0.2s;
        ">
          <div style="color: white; font-size: 18px; font-weight: bold;">‚ö° Medium</div>
          <div style="color: #fde68a; font-size: 13px; margin-top: 4px;">Balanced challenge, standard physics</div>
        </button>

        <button onclick="window.selectDifficulty('hard')" style="
          width: 100%;
          padding: 20px;
          margin-bottom: 12px;
          background: linear-gradient(135deg, #4d1a1a 0%, #6b2d2d 100%);
          border: 2px solid #f87171;
          border-radius: 12px;
          cursor: pointer;
          transition: transform 0.2s, box-shadow 0.2s;
        ">
          <div style="color: white; font-size: 18px; font-weight: bold;">üî• Hard</div>
          <div style="color: #fca5a5; font-size: 13px; margin-top: 4px;">Precise control required, smarter CPU</div>
        </button>

        <button onclick="window.goBackToModeSelect()" style="
          margin-top: 20px;
          padding: 12px 24px;
          background: transparent;
          border: 1px solid #64748b;
          border-radius: 8px;
          color: #94a3b8;
          font-size: 14px;
          cursor: pointer;
        ">‚Üê Back</button>
      </div>
    </div>

    <!-- Level Selection Screen (Quick Play) -->
    <div id="level-select-screen" style="
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: linear-gradient(135deg, #0d1117 0%, #1a1a2e 50%, #16213e 100%);
      z-index: 9000;
      overflow-y: auto;
    ">
      <div style="
        max-width: 400px;
        margin: 0 auto;
        padding: 60px 20px;
        font-family: 'Segoe UI', system-ui, sans-serif;
        text-align: center;
      ">
        <h1 style="
          color: white;
          font-size: 32px;
          margin-bottom: 12px;
        ">Career Level</h1>
        <p style="
          color: #94a3b8;
          font-size: 14px;
          margin-bottom: 30px;
        ">Choose where to start your journey</p>

        <button onclick="window.selectLevel('club')" style="
          width: 100%;
          padding: 20px;
          margin-bottom: 12px;
          background: linear-gradient(135deg, #1a3d1a 0%, #2d5a2d 100%);
          border: 2px solid #4ade80;
          border-radius: 12px;
          cursor: pointer;
          transition: transform 0.2s, box-shadow 0.2s;
          text-align: left;
        ">
          <div style="color: white; font-size: 18px; font-weight: bold;">üè† Club Level</div>
          <div style="color: #86efac; font-size: 13px; margin-top: 4px;">Local club competitions - perfect for beginners</div>
        </button>

        <button onclick="window.selectLevel('regionals')" style="
          width: 100%;
          padding: 20px;
          margin-bottom: 12px;
          background: linear-gradient(135deg, #1a3d4d 0%, #2d5a6b 100%);
          border: 2px solid #38bdf8;
          border-radius: 12px;
          cursor: pointer;
          transition: transform 0.2s, box-shadow 0.2s;
          text-align: left;
        ">
          <div style="color: white; font-size: 18px; font-weight: bold;">üèÖ Regionals</div>
          <div style="color: #7dd3fc; font-size: 13px; margin-top: 4px;">Regional championships - rising competition</div>
        </button>

        <button onclick="window.selectLevel('nationals')" style="
          width: 100%;
          padding: 20px;
          margin-bottom: 12px;
          background: linear-gradient(135deg, #4d3d1a 0%, #6b5a2d 100%);
          border: 2px solid #fbbf24;
          border-radius: 12px;
          cursor: pointer;
          transition: transform 0.2s, box-shadow 0.2s;
          text-align: left;
        ">
          <div style="color: white; font-size: 18px; font-weight: bold;">ü•á Nationals</div>
          <div style="color: #fde68a; font-size: 13px; margin-top: 4px;">National championships - elite competition</div>
        </button>

        <button onclick="window.selectLevel('worlds')" style="
          width: 100%;
          padding: 20px;
          margin-bottom: 12px;
          background: linear-gradient(135deg, #3d1a4d 0%, #5a2d6b 100%);
          border: 2px solid #c084fc;
          border-radius: 12px;
          cursor: pointer;
          transition: transform 0.2s, box-shadow 0.2s;
          text-align: left;
        ">
          <div style="color: white; font-size: 18px; font-weight: bold;">üåç World Championship</div>
          <div style="color: #d8b4fe; font-size: 13px; margin-top: 4px;">Compete against the world's best</div>
        </button>

        <button onclick="window.selectLevel('olympics')" style="
          width: 100%;
          padding: 20px;
          margin-bottom: 12px;
          background: linear-gradient(135deg, #4d1a1a 0%, #6b2d2d 100%);
          border: 2px solid #fbbf24;
          border-radius: 12px;
          cursor: pointer;
          transition: transform 0.2s, box-shadow 0.2s;
          text-align: left;
        ">
          <div style="display: flex; align-items: center; gap: 8px;">
            <span style="font-size: 24px;">üèÖ</span>
            <span style="color: white; font-size: 18px; font-weight: bold;">Olympics</span>
            <span style="font-size: 16px;">ü•àü•â</span>
          </div>
          <div style="color: #fca5a5; font-size: 13px; margin-top: 4px;">The ultimate test - compete for gold</div>
        </button>

        <button onclick="window.goBackToDifficulty()" style="
          margin-top: 20px;
          padding: 12px 24px;
          background: transparent;
          border: 1px solid #64748b;
          border-radius: 8px;
          color: #94a3b8;
          font-size: 14px;
          cursor: pointer;
        ">‚Üê Back</button>
      </div>
    </div>

    <!-- Country Selection Screen -->
    <div id="country-select-screen" style="
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: linear-gradient(135deg, #0d1117 0%, #1a1a2e 50%, #16213e 100%);
      z-index: 9000;
      overflow-y: auto;
    ">
      <div style="
        max-width: 500px;
        margin: 0 auto;
        padding: 40px 20px;
        font-family: 'Segoe UI', system-ui, sans-serif;
      ">
        <h1 style="
          text-align: center;
          color: white;
          font-size: 28px;
          margin-bottom: 10px;
        ">Choose Your Country</h1>
        <p style="
          text-align: center;
          color: #94a3b8;
          font-size: 14px;
          margin-bottom: 30px;
        ">Select the nation you'll represent</p>
        <div id="country-grid" style="
          display: grid;
          grid-template-columns: repeat(2, 1fr);
          gap: 12px;
        ">
          <!-- Countries populated by JS -->
        </div>
      </div>
    </div>

    <!-- Settings Summary Screen -->
    <div id="settings-summary-screen" style="
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: linear-gradient(135deg, #0d1117 0%, #1a1a2e 50%, #16213e 100%);
      z-index: 9000;
      overflow-y: auto;
    ">
      <div style="
        max-width: 400px;
        margin: 0 auto;
        padding: 40px 20px;
        font-family: 'Segoe UI', system-ui, sans-serif;
        text-align: center;
      ">
        <h1 style="color: white; font-size: 28px; margin-bottom: 30px;">Match Setup</h1>

        <div style="
          background: rgba(255,255,255,0.05);
          border-radius: 16px;
          padding: 24px;
          margin-bottom: 24px;
        ">
          <div style="display: flex; justify-content: center; align-items: center; gap: 20px; margin-bottom: 20px;">
            <div style="text-align: center;">
              <div id="summary-player-flag" style="font-size: 48px;">üá®üá¶</div>
              <div id="summary-player-name" style="color: white; font-size: 14px; margin-top: 8px;">Canada</div>
              <div style="color: #4ade80; font-size: 12px;">YOU</div>
            </div>
            <div style="color: #64748b; font-size: 24px; font-weight: bold;">VS</div>
            <div style="text-align: center;">
              <div id="summary-opponent-flag" style="font-size: 48px;">üá∏üá™</div>
              <div id="summary-opponent-name" style="color: white; font-size: 14px; margin-top: 8px;">Sweden</div>
              <div style="color: #94a3b8; font-size: 12px;">CPU</div>
            </div>
          </div>

          <div style="border-top: 1px solid rgba(255,255,255,0.1); padding-top: 16px;">
            <div style="color: #94a3b8; font-size: 13px; margin-bottom: 8px;">
              <span id="summary-mode">Career Mode</span> ‚Ä¢ <span id="summary-level">Club Level</span>
            </div>
          </div>
        </div>

        <p style="color: #64748b; font-size: 13px; margin-bottom: 24px;">
          Tap ‚öôÔ∏è during the game to change settings
        </p>

        <button id="play-button" onclick="window.startCoinToss()" style="
          background: linear-gradient(135deg, #22c55e, #16a34a);
          border: none;
          color: white;
          font-size: 20px;
          font-weight: bold;
          padding: 16px 48px;
          border-radius: 12px;
          cursor: pointer;
          box-shadow: 0 4px 20px rgba(34, 197, 94, 0.4);
          transition: transform 0.2s, box-shadow 0.2s;
        ">PLAY</button>
      </div>
    </div>

    <!-- Coin Toss Overlay -->
    <div id="coin-toss-overlay" style="
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.9);
      z-index: 9500;
      justify-content: center;
      align-items: center;
      font-family: 'Segoe UI', system-ui, sans-serif;
    ">
      <div style="text-align: center;">
        <h2 id="toss-title" style="color: white; font-size: 24px; margin-bottom: 30px;">Coin Toss</h2>
        <div id="coin" style="
          width: 120px;
          height: 120px;
          margin: 0 auto 30px auto;
          font-size: 80px;
          line-height: 120px;
          border-radius: 50%;
          background: linear-gradient(135deg, #ffd700, #ffaa00);
          box-shadow: 0 4px 30px rgba(255, 215, 0, 0.5);
          transform-style: preserve-3d;
        ">ü™ô</div>
        <p id="toss-result" style="color: #4ade80; font-size: 20px; font-weight: bold; display: none;"></p>
        <p id="toss-subtitle" style="color: #94a3b8; font-size: 14px; margin-top: 10px;"></p>
      </div>
    </div>

    <!-- Hammer/Color Choice Overlay (when player wins toss) -->
    <div id="toss-choice-overlay" style="
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.9);
      z-index: 9600;
      justify-content: center;
      align-items: center;
      font-family: 'Segoe UI', system-ui, sans-serif;
    ">
      <div style="text-align: center; padding: 20px;">
        <h2 style="color: #4ade80; font-size: 24px; margin-bottom: 10px;">You Won the Toss!</h2>
        <p style="color: #94a3b8; font-size: 14px; margin-bottom: 30px;">Choose your advantage</p>

        <div style="display: flex; flex-direction: column; gap: 16px; max-width: 300px; margin: 0 auto;">
          <button onclick="window.chooseTossOption('hammer')" style="
            background: linear-gradient(135deg, #f59e0b, #d97706);
            border: none;
            color: white;
            font-size: 18px;
            font-weight: bold;
            padding: 20px;
            border-radius: 12px;
            cursor: pointer;
            box-shadow: 0 4px 20px rgba(245, 158, 11, 0.4);
          ">
            üî® Take Hammer
            <div style="font-size: 12px; font-weight: normal; margin-top: 4px; opacity: 0.9;">Last stone advantage</div>
          </button>

          <button onclick="window.chooseTossOption('color')" style="
            background: linear-gradient(135deg, #3b82f6, #2563eb);
            border: none;
            color: white;
            font-size: 18px;
            font-weight: bold;
            padding: 20px;
            border-radius: 12px;
            cursor: pointer;
            box-shadow: 0 4px 20px rgba(59, 130, 246, 0.4);
          ">
            üé® Choose Color
            <div style="font-size: 12px; font-weight: normal; margin-top: 4px; opacity: 0.9;">Throw first this end</div>
          </button>
        </div>
      </div>
    </div>

    <!-- Color Choice Overlay (when player chooses color option) -->
    <div id="color-choice-overlay" style="
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.9);
      z-index: 1001;
      justify-content: center;
      align-items: center;
    ">
      <div style="text-align: center; padding: 20px;">
        <h2 style="color: #4ade80; font-size: 24px; margin-bottom: 10px;">Choose Your Stone Color</h2>
        <p style="color: #94a3b8; font-size: 14px; margin-bottom: 30px;">Your country will play with the color you choose</p>

        <div style="display: flex; gap: 20px; justify-content: center;">
          <button onclick="window.chooseColor('red')" style="
            background: linear-gradient(135deg, #ef4444, #dc2626);
            border: none;
            color: white;
            font-size: 18px;
            font-weight: bold;
            padding: 20px;
            width: 140px;
            border-radius: 12px;
            cursor: pointer;
            box-shadow: 0 4px 20px rgba(239, 68, 68, 0.4);
          ">
            <!-- Curling stone icon - realistic style -->
            <div style="width: 70px; height: 58px; margin: 0 auto 12px; position: relative;">
              <!-- Gray granite stone body -->
              <div style="position: absolute; bottom: 0; left: 50%; transform: translateX(-50%); width: 60px; height: 32px; background: linear-gradient(to bottom, #9ca3af, #6b7280 40%, #4b5563); border-radius: 8px 8px 30px 30px; box-shadow: 0 4px 8px rgba(0,0,0,0.5);"></div>
              <!-- Red top cap -->
              <div style="position: absolute; top: 18px; left: 50%; transform: translateX(-50%); width: 48px; height: 16px; background: linear-gradient(to bottom, #f87171, #dc2626 50%, #b91c1c); border-radius: 50%; box-shadow: 0 2px 4px rgba(0,0,0,0.3);"></div>
              <!-- Handle - gooseneck style -->
              <div style="position: absolute; top: 6px; left: 42%; width: 6px; height: 20px; background: linear-gradient(to right, #fca5a5, #ef4444, #dc2626); border-radius: 3px; transform: rotate(-15deg); transform-origin: bottom center;"></div>
              <!-- Handle curve/grip -->
              <div style="position: absolute; top: 0; left: 38%; width: 20px; height: 10px; background: linear-gradient(to bottom, #f87171, #dc2626); border-radius: 10px 10px 4px 4px; transform: rotate(-10deg);"></div>
            </div>
            <div>Red<br>Stones</div>
          </button>

          <button onclick="window.chooseColor('yellow')" style="
            background: linear-gradient(135deg, #eab308, #ca8a04);
            border: none;
            color: white;
            font-size: 18px;
            font-weight: bold;
            padding: 20px;
            width: 140px;
            border-radius: 12px;
            cursor: pointer;
            box-shadow: 0 4px 20px rgba(234, 179, 8, 0.4);
          ">
            <!-- Curling stone icon - realistic style -->
            <div style="width: 70px; height: 58px; margin: 0 auto 12px; position: relative;">
              <!-- Gray granite stone body -->
              <div style="position: absolute; bottom: 0; left: 50%; transform: translateX(-50%); width: 60px; height: 32px; background: linear-gradient(to bottom, #9ca3af, #6b7280 40%, #4b5563); border-radius: 8px 8px 30px 30px; box-shadow: 0 4px 8px rgba(0,0,0,0.5);"></div>
              <!-- Yellow top cap -->
              <div style="position: absolute; top: 18px; left: 50%; transform: translateX(-50%); width: 48px; height: 16px; background: linear-gradient(to bottom, #fde047, #eab308 50%, #ca8a04); border-radius: 50%; box-shadow: 0 2px 4px rgba(0,0,0,0.3);"></div>
              <!-- Handle - gooseneck style -->
              <div style="position: absolute; top: 6px; left: 42%; width: 6px; height: 20px; background: linear-gradient(to right, #fef08a, #eab308, #ca8a04); border-radius: 3px; transform: rotate(-15deg); transform-origin: bottom center;"></div>
              <!-- Handle curve/grip -->
              <div style="position: absolute; top: 0; left: 38%; width: 20px; height: 10px; background: linear-gradient(to bottom, #fde047, #eab308); border-radius: 10px 10px 4px 4px; transform: rotate(-10deg);"></div>
            </div>
            <div>Yellow<br>Stones</div>
          </button>
        </div>
      </div>
    </div>

    <!-- Team Assignment Announcement Overlay -->
    <div id="team-assignment-overlay" style="
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.95);
      z-index: 9700;
      justify-content: center;
      align-items: center;
      font-family: 'Segoe UI', system-ui, sans-serif;
    ">
      <div style="text-align: center; padding: 20px;">
        <h2 id="assignment-title" style="color: #4ade80; font-size: 28px; margin-bottom: 20px;">Teams Assigned</h2>
        <div id="assignment-your-team" style="font-size: 48px; margin-bottom: 10px;"></div>
        <p id="assignment-your-label" style="color: #e2e8f0; font-size: 18px; margin-bottom: 30px;"></p>
        <div style="color: #64748b; font-size: 14px;">
          <span id="assignment-hammer-info"></span>
        </div>
      </div>
    </div>

    <!-- Multiplayer Chat -->
    <div id="mp-chat-container" style="
      display: none;
      position: fixed;
      bottom: max(20px, env(safe-area-inset-bottom));
      right: max(20px, env(safe-area-inset-right));
      z-index: 500;
      font-family: 'Segoe UI', system-ui, sans-serif;
    ">
      <!-- Chat Button -->
      <button id="mp-chat-btn" onclick="window.toggleChat()" style="
        width: 50px;
        height: 50px;
        border-radius: 50%;
        background: linear-gradient(135deg, #3b82f6, #2563eb);
        border: none;
        color: white;
        font-size: 24px;
        cursor: pointer;
        box-shadow: 0 4px 15px rgba(59, 130, 246, 0.4);
        position: relative;
      ">
        üí¨
        <span id="mp-chat-badge" style="
          display: none;
          position: absolute;
          top: -5px;
          right: -5px;
          background: #ef4444;
          color: white;
          font-size: 12px;
          font-weight: bold;
          width: 20px;
          height: 20px;
          border-radius: 50%;
          line-height: 20px;
        ">0</span>
      </button>

      <!-- Chat Panel -->
      <div id="mp-chat-panel" style="
        display: none;
        position: absolute;
        bottom: 60px;
        right: 0;
        width: 280px;
        max-height: 350px;
        background: rgba(30, 30, 40, 0.95);
        border-radius: 12px;
        border: 1px solid #444;
        box-shadow: 0 8px 32px rgba(0, 0, 0, 0.5);
        overflow: hidden;
      ">
        <!-- Chat Header -->
        <div style="
          padding: 12px 15px;
          background: rgba(0, 0, 0, 0.3);
          border-bottom: 1px solid #333;
          display: flex;
          justify-content: space-between;
          align-items: center;
        ">
          <span style="color: #e2e8f0; font-weight: bold; font-size: 14px;">Chat</span>
          <button onclick="window.toggleChat()" style="
            background: none;
            border: none;
            color: #94a3b8;
            font-size: 18px;
            cursor: pointer;
          ">‚úï</button>
        </div>

        <!-- Chat Messages -->
        <div id="mp-chat-messages" style="
          height: 200px;
          overflow-y: auto;
          padding: 10px;
        "></div>

        <!-- Chat Input -->
        <div style="
          padding: 10px;
          border-top: 1px solid #333;
          display: flex;
          gap: 8px;
        ">
          <input type="text" id="mp-chat-input" placeholder="Type a message..."
            onkeypress="if(event.key==='Enter')window.sendChatMessage()"
            onfocus="window.onChatInputFocus(event)"
            onblur="window.onChatInputBlur()"
            style="
              flex: 1;
              padding: 10px 12px;
              border-radius: 20px;
              border: 1px solid #444;
              background: #1a1a2e;
              color: white;
              font-size: 14px;
              outline: none;
            "
          />
          <button onclick="window.sendChatMessage()" style="
            padding: 10px 15px;
            border-radius: 20px;
            background: #3b82f6;
            border: none;
            color: white;
            font-size: 14px;
            cursor: pointer;
          ">Send</button>
        </div>
      </div>
    </div>

    <!-- Chat Toast Notifications -->
    <div id="mp-chat-toasts" style="
      position: fixed;
      bottom: max(80px, calc(env(safe-area-inset-bottom) + 60px));
      right: max(20px, env(safe-area-inset-right));
      z-index: 499;
      display: flex;
      flex-direction: column-reverse;
      gap: 8px;
      pointer-events: none;
    "></div>

    <style>
      @keyframes fadeInUp {
        from {
          opacity: 0;
          transform: translateY(10px);
        }
        to {
          opacity: 1;
          transform: translateY(0);
        }
      }

      @keyframes coin-flip {
        0% {
          transform: translateY(0) rotateY(0deg) rotateX(0deg) scale(1);
          box-shadow: 0 4px 30px rgba(255, 215, 0, 0.5);
        }
        15% {
          transform: translateY(-150px) rotateY(540deg) rotateX(180deg) scale(1.2);
          box-shadow: 0 30px 60px rgba(255, 215, 0, 0.3);
        }
        30% {
          transform: translateY(-200px) rotateY(1080deg) rotateX(360deg) scale(1.1);
          box-shadow: 0 40px 80px rgba(255, 215, 0, 0.2);
        }
        50% {
          transform: translateY(-180px) rotateY(1440deg) rotateX(540deg) scale(1.15);
          box-shadow: 0 35px 70px rgba(255, 215, 0, 0.25);
        }
        70% {
          transform: translateY(-80px) rotateY(1620deg) rotateX(630deg) scale(1.05);
          box-shadow: 0 20px 40px rgba(255, 215, 0, 0.4);
        }
        85% {
          transform: translateY(10px) rotateY(1750deg) rotateX(700deg) scale(0.98);
          box-shadow: 0 5px 20px rgba(255, 215, 0, 0.6);
        }
        92% {
          transform: translateY(-5px) rotateY(1780deg) rotateX(710deg) scale(1.02);
        }
        100% {
          transform: translateY(0) rotateY(1800deg) rotateX(720deg) scale(1);
          box-shadow: 0 4px 30px rgba(255, 215, 0, 0.5);
        }
      }
      .coin-flipping {
        animation: coin-flip 2s cubic-bezier(0.25, 0.46, 0.45, 0.94) forwards;
      }
      #play-button:hover {
        transform: scale(1.05);
        box-shadow: 0 6px 30px rgba(34, 197, 94, 0.5);
      }
      #play-button:active {
        transform: scale(0.98);
      }
      .country-btn {
        background: rgba(255,255,255,0.05);
        border: 2px solid transparent;
        border-radius: 12px;
        padding: 16px;
        cursor: pointer;
        transition: all 0.2s;
        text-align: center;
      }
      .country-btn:hover {
        background: rgba(255,255,255,0.1);
        border-color: rgba(74, 222, 128, 0.3);
      }
      .country-btn.selected {
        background: rgba(74, 222, 128, 0.15);
        border-color: #4ade80;
      }
    </style>

    <div id="ui">
      <div id="scoreboard">
        <table id="score-table">
          <thead>
            <tr>
              <th class="team-col"></th>
              <th class="hammer-col">H</th>
              <th id="header-end-1">1</th><th id="header-end-2">2</th><th id="header-end-3">3</th><th id="header-end-4">4</th><th id="header-end-5">5</th><th id="header-end-6">6</th><th id="header-end-7">7</th><th id="header-end-8">8</th><th id="header-end-9" style="display:none">9</th><th id="header-end-10" style="display:none">10</th>
              <th class="total-col">Total</th>
            </tr>
          </thead>
          <tbody>
            <tr id="red-score-row">
              <td class="team-col team-red">RED</td>
              <td class="hammer-col" id="red-hammer"></td>
              <td id="red-end-1"></td><td id="red-end-2"></td><td id="red-end-3"></td><td id="red-end-4"></td>
              <td id="red-end-5"></td><td id="red-end-6"></td><td id="red-end-7"></td><td id="red-end-8"></td>
              <td id="red-end-9" style="display:none"></td><td id="red-end-10" style="display:none"></td>
              <td class="total-col" id="red-total">0</td>
            </tr>
            <tr id="yellow-score-row">
              <td class="team-col team-yellow">YEL</td>
              <td class="hammer-col" id="yellow-hammer"></td>
              <td id="yellow-end-1"></td><td id="yellow-end-2"></td><td id="yellow-end-3"></td><td id="yellow-end-4"></td>
              <td id="yellow-end-5"></td><td id="yellow-end-6"></td><td id="yellow-end-7"></td><td id="yellow-end-8"></td>
              <td id="yellow-end-9" style="display:none"></td><td id="yellow-end-10" style="display:none"></td>
              <td class="total-col" id="yellow-total">0</td>
            </tr>
          </tbody>
        </table>
      </div>
      <!-- Turn and Stone Count Row -->
      <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 6px;">
        <div style="display: flex; align-items: center; gap: 12px;">
          <div id="turn" style="margin: 0;">End 1 - Red's Turn</div>
          <div id="turn-timer" style="
            display: none;
            background: #333;
            padding: 2px 8px;
            border-radius: 4px;
            font-size: 14px;
            font-weight: bold;
            min-width: 45px;
            text-align: center;
          ">60</div>
        </div>
        <div id="stone-count" style="
          display: flex;
          gap: 12px;
          font-size: 12px;
          margin-left: 20px;
        ">
          <div id="red-stones" style="display: flex; align-items: center; gap: 3px;">
            <span style="color: #dc2626; font-weight: bold;">R:</span>
            <div id="red-stone-icons" style="display: flex; gap: 2px;"></div>
          </div>
          <div id="yellow-stones" style="display: flex; align-items: center; gap: 3px;">
            <span style="color: #fbbf24; font-weight: bold;">Y:</span>
            <div id="yellow-stone-icons" style="display: flex; gap: 2px;"></div>
          </div>
        </div>
      </div>
      <!-- Career Display -->
      <div id="career-display" style="
        margin-bottom: 6px;
        display: flex;
        gap: 8px;
        align-items: center;
        font-size: 12px;
      ">
        <span style="color: #94a3b8;">Level:</span>
        <span id="career-level" style="font-weight: bold;">Club</span>
        <span id="career-difficulty" style="font-size: 11px; color: #94a3b8;">(Beginner)</span>
        <span id="career-progress" style="font-size: 11px; color: #64748b;">0/2 wins</span>
      </div>
      <!-- Curl/Handle Control (hidden until target placed) -->
      <div id="curl-display" style="margin-top: 0; padding: 8px; display: none;">
        <div id="curl-direction" style="color: #fff; font-size: 13px; margin-bottom: 6px;">
          Handle: <span id="handle-value">0</span>
        </div>
        <div class="curl-slider-container" style="position: relative; width: 100%; padding: 0 5px;">
          <div style="display: flex; justify-content: space-between; font-size: 10px; color: #94a3b8; margin-bottom: 4px;">
            <span>‚Ü∫ CCW</span>
            <span style="color: #f59e0b;">MORE CURL</span>
            <span>CW ‚Üª</span>
          </div>
          <input type="range" id="curl-slider" min="-100" max="100" value="0"
            oninput="window.updateCurlSlider(this.value)"
            style="
              width: 100%;
              height: 24px;
              -webkit-appearance: none;
              appearance: none;
              background: linear-gradient(to right, #3b82f6 0%, #f59e0b 50%, #22c55e 100%);
              border-radius: 12px;
              outline: none;
              cursor: pointer;
            ">
          <div style="display: flex; justify-content: space-between; font-size: 9px; color: #64748b; margin-top: 2px;">
            <span>STRAIGHTER</span>
            <span>STRAIGHTER</span>
          </div>
        </div>
      </div>
      <div id="power-display">
        <div id="phase-text">Pull back to set power...</div>
        <div>Effort: <span id="power-value">0</span>%</div>
        <div id="shot-type" style="font-weight: bold; font-size: 18px; margin: 5px 0;">Ultra Light Guard</div>
        <div id="power-bar"><div id="power-fill"></div></div>
        <div id="hold-warning">Must release before hog line!</div>
      </div>
    </div>
    <div id="sweep-indicator">SWEEPING!</div>
    <div id="marker-hint">Click on the ice to set your target</div>
    <button id="return-to-throw" onclick="window.returnToThrowView()" ontouchend="window.returnToThrowView(); event.preventDefault();">READY</button>
    <style>
      #return-to-throw {
        position: fixed;
        bottom: max(30px, env(safe-area-inset-bottom));
        left: 50%;
        transform: translateX(-50%);
        padding: 20px 50px;
        font-size: 32px;
        font-weight: bold;
        background: linear-gradient(135deg, #22c55e 0%, #16a34a 50%, #15803d 100%);
        color: #fff;
        border: 3px solid #4ade80;
        border-radius: 50px;
        cursor: pointer;
        display: none;
        z-index: 100;
        box-shadow: 0 4px 20px rgba(74, 222, 128, 0.5), 0 0 40px rgba(74, 222, 128, 0.3);
        text-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);
        font-family: 'Segoe UI', system-ui, sans-serif;
        letter-spacing: 2px;
        animation: pulse-glow 2s ease-in-out infinite;
        transition: all 0.2s ease;
        user-select: none;
        -webkit-user-select: none;
        -webkit-touch-callout: none;
      }
      #return-to-throw:hover {
        transform: translateX(-50%) scale(1.05);
        box-shadow: 0 6px 30px rgba(74, 222, 128, 0.7), 0 0 50px rgba(74, 222, 128, 0.4);
        background: linear-gradient(135deg, #4ade80 0%, #22c55e 50%, #16a34a 100%);
      }
      #return-to-throw:active {
        transform: translateX(-50%) scale(0.98);
      }
      @keyframes pulse-glow {
        0%, 100% { box-shadow: 0 4px 20px rgba(74, 222, 128, 0.5), 0 0 40px rgba(74, 222, 128, 0.3); }
        50% { box-shadow: 0 4px 30px rgba(74, 222, 128, 0.7), 0 0 60px rgba(74, 222, 128, 0.5); }
      }
    </style>
    <div id="split-time" style="
      position: fixed;
      top: 50%;
      right: max(30px, env(safe-area-inset-right));
      transform: translateY(-50%);
      font-family: 'Segoe UI', sans-serif;
      font-size: 28px;
      font-weight: bold;
      background: rgba(0,0,0,0.7);
      padding: 15px 25px;
      border-radius: 10px;
      display: none;
      pointer-events: none;
    "></div>
    <!-- Score Announcement Overlay -->
    <div id="score-overlay">
      <div id="score-card">
        <h2 id="score-end-label">End 1 Complete</h2>
        <div id="score-team" class="red">RED</div>
        <div id="score-stones-display"></div>
        <div id="score-points">2</div>
        <div id="score-points-label">Points Scored</div>
        <div id="score-totals">
          <div class="score-total">
            <div class="score-total-label">Red</div>
            <div class="score-total-value red" id="score-total-red">0</div>
          </div>
          <div class="score-total">
            <div class="score-total-label">Yellow</div>
            <div class="score-total-value yellow" id="score-total-yellow">0</div>
          </div>
        </div>
        <button id="score-continue" onclick="window.continueGame()">Continue</button>
      </div>
    </div>
    <!-- Game Over Overlay -->
    <div id="gameover-overlay">
      <div id="gameover-card">
        <div id="gameover-title">Game Over</div>
        <div id="gameover-winner" class="red">RED</div>
        <div id="gameover-subtitle">WINS!</div>
        <div id="gameover-final-scores">
          <div class="final-score">
            <div class="final-score-label">Red</div>
            <div class="final-score-value red" id="gameover-red">0</div>
          </div>
          <div class="final-score">
            <div class="final-score-label">Yellow</div>
            <div class="final-score-value yellow" id="gameover-yellow">0</div>
          </div>
        </div>
        <div id="gameover-career-message" style="
          margin-top: 20px;
          font-size: 18px;
          font-weight: bold;
          display: none;
        "></div>
        <div id="gameover-buttons" style="display: flex; flex-direction: column; gap: 10px; margin-top: 20px;">
          <button id="gameover-rematch" onclick="window.requestRematch()" style="
            display: none;
            padding: 15px 40px;
            font-size: 18px;
            font-weight: bold;
            background: linear-gradient(135deg, #059669 0%, #10b981 100%);
            border: 2px solid #34d399;
            border-radius: 10px;
            color: white;
            cursor: pointer;
            transition: all 0.2s;
          ">Rematch</button>
          <button id="gameover-restart" onclick="window.restartGame()">Main Menu</button>
        </div>
      </div>
    </div>
    <!-- Rematch Request Overlay -->
    <div id="rematch-request-overlay" style="
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.85);
      z-index: 9600;
      justify-content: center;
      align-items: center;
      font-family: 'Segoe UI', system-ui, sans-serif;
    ">
      <div style="
        background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
        border: 3px solid #4a5568;
        border-radius: 16px;
        padding: 30px;
        width: 90%;
        max-width: 400px;
        text-align: center;
      ">
        <div style="font-size: 48px; margin-bottom: 16px;">üîÑ</div>
        <h2 id="rematch-title" style="color: white; margin: 0 0 8px 0; font-size: 22px;">Rematch Request</h2>
        <p id="rematch-message" style="color: #94a3b8; margin: 0 0 24px 0; font-size: 16px;">Opponent wants to play again!</p>
        <div id="rematch-buttons" style="display: flex; gap: 12px; justify-content: center;">
          <button onclick="window.acceptRematch()" style="
            flex: 1;
            padding: 14px 20px;
            font-size: 16px;
            font-weight: bold;
            background: linear-gradient(135deg, #059669 0%, #10b981 100%);
            border: none;
            border-radius: 8px;
            color: white;
            cursor: pointer;
          ">Accept</button>
          <button onclick="window.declineRematch()" style="
            flex: 1;
            padding: 14px 20px;
            font-size: 16px;
            font-weight: bold;
            background: linear-gradient(135deg, #dc2626 0%, #ef4444 100%);
            border: none;
            border-radius: 8px;
            color: white;
            cursor: pointer;
          ">Decline</button>
        </div>
        <div id="rematch-waiting" style="display: none; color: #fbbf24; margin-top: 16px;">
          Waiting for opponent...
        </div>
      </div>
    </div>
    <!-- Settings Modal -->
    <div id="settings-overlay" onclick="if(event.target === this) window.closeSettings()" style="
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.8);
      z-index: 2000;
      justify-content: center;
      align-items: center;
      cursor: pointer;
    ">
      <div id="settings-modal" onclick="event.stopPropagation()" style="
        background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
        border: 3px solid #4a5568;
        border-radius: 16px;
        cursor: default;
        padding: 30px;
        min-width: 320px;
        max-width: 400px;
        max-height: 85vh;
        overflow-y: auto;
        color: white;
        font-family: 'Segoe UI', system-ui, sans-serif;
        box-shadow: 0 10px 40px rgba(0, 0, 0, 0.5);
      ">
        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 25px;">
          <h2 style="margin: 0; font-size: 24px;">‚öôÔ∏è Settings</h2>
          <button onclick="window.closeSettings()" style="
            background: none;
            border: none;
            color: #888;
            font-size: 28px;
            cursor: pointer;
            padding: 0;
            line-height: 1;
          ">&times;</button>
        </div>

        <!-- Game Mode Setting -->
        <div style="margin-bottom: 25px;">
          <label style="display: block; margin-bottom: 10px; font-weight: bold; color: #a0aec0;">
            Game Mode
          </label>
          <div style="display: flex; flex-direction: column; gap: 8px;">
            <button class="mode-btn" id="mode-career" data-mode="career" onclick="window.setGameMode('1player')" style="
              padding: 12px;
              border: 2px solid #4ade80;
              background: #2d5a3d;
              color: white;
              border-radius: 6px;
              cursor: pointer;
              font-size: 14px;
              transition: all 0.2s;
              text-align: left;
            ">
              <div style="font-weight: bold;">üèÜ Career Mode</div>
              <div style="font-size: 11px; color: #94a3b8; margin-top: 4px;">Start at Club level and work your way to the Olympics</div>
            </button>
            <button class="mode-btn" id="mode-quickplay" data-mode="quickplay" onclick="window.setGameMode('2player')" style="
              padding: 12px;
              border: 2px solid #666;
              background: #333;
              color: white;
              border-radius: 6px;
              cursor: pointer;
              font-size: 14px;
              transition: all 0.2s;
              text-align: left;
            ">
              <div style="font-weight: bold;">üéÆ Quick Play</div>
              <div style="font-size: 11px; color: #94a3b8; margin-top: 4px;">Jump into a game at any difficulty level</div>
            </button>
            <button class="mode-btn" id="mode-online" disabled style="
              padding: 12px;
              border: 2px solid #444;
              background: #252525;
              color: #666;
              border-radius: 6px;
              cursor: not-allowed;
              font-size: 14px;
              text-align: left;
              opacity: 0.7;
            ">
              <div style="display: flex; justify-content: space-between; align-items: center;">
                <span style="font-weight: bold;">üåê Online Multiplayer</span>
                <span style="font-size: 10px; background: #4a5568; color: #a0aec0; padding: 2px 8px; border-radius: 10px;">COMING SOON</span>
              </div>
              <div style="font-size: 11px; color: #555; margin-top: 4px;">Challenge players worldwide</div>
            </button>
          </div>
        </div>

        <!-- Learn Mode -->
        <div style="margin-bottom: 25px;">
          <label style="display: block; margin-bottom: 10px; font-weight: bold; color: #a0aec0;">
            Learn Mode
          </label>
          <button id="learn-mode-btn" onclick="window.setGameMode('learn')" style="
            width: 100%;
            padding: 12px;
            border: 2px solid #666;
            background: #333;
            color: white;
            border-radius: 6px;
            cursor: pointer;
            font-size: 14px;
            text-align: left;
            transition: all 0.2s;
          ">
            <div style="display: flex; justify-content: space-between; align-items: center;">
              <span style="font-weight: bold;">üìö Learn to Curl</span>
              <span id="learn-mode-badge" style="font-size: 10px; background: #4ade80; color: #000; padding: 2px 8px; border-radius: 10px; display: none;">ACTIVE</span>
            </div>
            <div style="font-size: 11px; color: #94a3b8; margin-top: 4px;">AI coach suggests shots, explains strategy, and guides your play</div>
          </button>
        </div>

        <!-- Learn Level Selector (only shown in Learn mode) -->
        <div id="learn-level-section" style="margin-bottom: 25px; display: none;">
          <label style="display: block; margin-bottom: 10px; font-weight: bold; color: #a0aec0;">
            Your Experience Level
          </label>
          <div style="display: flex; flex-direction: column; gap: 6px;">
            <button class="learn-level-btn" data-level="1" onclick="window.setLearnLevel(1)" style="
              padding: 10px 12px;
              border: 2px solid #4ade80;
              background: #2d5a3d;
              color: white;
              border-radius: 6px;
              cursor: pointer;
              font-size: 12px;
              transition: all 0.2s;
              text-align: left;
            "><span style="color: #4ade80;">‚óè</span> Complete Beginner - <span style="color: #94a3b8;">New to curling</span></button>
            <button class="learn-level-btn" data-level="2" onclick="window.setLearnLevel(2)" style="
              padding: 10px 12px;
              border: 2px solid #666;
              background: #333;
              color: white;
              border-radius: 6px;
              cursor: pointer;
              font-size: 12px;
              transition: all 0.2s;
              text-align: left;
            "><span style="color: #3b82f6;">‚óè</span> Know the Basics - <span style="color: #94a3b8;">Learning strategy</span></button>
            <button class="learn-level-btn" data-level="3" onclick="window.setLearnLevel(3)" style="
              padding: 10px 12px;
              border: 2px solid #666;
              background: #333;
              color: white;
              border-radius: 6px;
              cursor: pointer;
              font-size: 12px;
              transition: all 0.2s;
              text-align: left;
            "><span style="color: #f59e0b;">‚óè</span> Intermediate - <span style="color: #94a3b8;">Strategic play</span></button>
            <button class="learn-level-btn" data-level="4" onclick="window.setLearnLevel(4)" style="
              padding: 10px 12px;
              border: 2px solid #666;
              background: #333;
              color: white;
              border-radius: 6px;
              cursor: pointer;
              font-size: 12px;
              transition: all 0.2s;
              text-align: left;
            "><span style="color: #ef4444;">‚óè</span> Advanced - <span style="color: #94a3b8;">Minimal coaching</span></button>
          </div>
          <p id="learn-level-description" style="margin: 10px 0 0 0; font-size: 12px; color: #718096;">
            Full tutorial with rules, controls, and simple suggestions
          </p>
        </div>

        <!-- Quick Play Level Selector (only shown in Quick Play mode) -->
        <div id="quickplay-level-section" style="margin-bottom: 25px; display: none;">
          <label style="display: block; margin-bottom: 10px; font-weight: bold; color: #a0aec0;">
            Select Level
          </label>
          <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 6px;">
            <button class="level-btn" data-level="1" onclick="window.setQuickPlayLevel(1)" style="
              padding: 10px 8px;
              border: 2px solid #666;
              background: #333;
              color: white;
              border-radius: 6px;
              cursor: pointer;
              font-size: 12px;
              transition: all 0.2s;
              text-align: left;
            "><span style="color: #6b7280;">‚óè</span> Club</button>
            <button class="level-btn" data-level="2" onclick="window.setQuickPlayLevel(2)" style="
              padding: 10px 8px;
              border: 2px solid #666;
              background: #333;
              color: white;
              border-radius: 6px;
              cursor: pointer;
              font-size: 12px;
              transition: all 0.2s;
              text-align: left;
            "><span style="color: #3b82f6;">‚óè</span> Regional</button>
            <button class="level-btn" data-level="3" onclick="window.setQuickPlayLevel(3)" style="
              padding: 10px 8px;
              border: 2px solid #666;
              background: #333;
              color: white;
              border-radius: 6px;
              cursor: pointer;
              font-size: 12px;
              transition: all 0.2s;
              text-align: left;
            "><span style="color: #8b5cf6;">‚óè</span> Provincial</button>
            <button class="level-btn" data-level="4" onclick="window.setQuickPlayLevel(4)" style="
              padding: 10px 8px;
              border: 2px solid #4ade80;
              background: #2d5a3d;
              color: white;
              border-radius: 6px;
              cursor: pointer;
              font-size: 12px;
              transition: all 0.2s;
              text-align: left;
            "><span style="color: #ef4444;">‚óè</span> National</button>
            <button class="level-btn" data-level="5" onclick="window.setQuickPlayLevel(5)" style="
              padding: 10px 8px;
              border: 2px solid #666;
              background: #333;
              color: white;
              border-radius: 6px;
              cursor: pointer;
              font-size: 12px;
              transition: all 0.2s;
              text-align: left;
            "><span style="color: #f59e0b;">‚óè</span> International</button>
            <button class="level-btn" data-level="6" onclick="window.setQuickPlayLevel(6)" style="
              padding: 10px 8px;
              border: 2px solid #666;
              background: #333;
              color: white;
              border-radius: 6px;
              cursor: pointer;
              font-size: 12px;
              transition: all 0.2s;
              text-align: left;
            "><span style="color: #10b981;">‚óè</span> World Champ</button>
            <button class="level-btn" data-level="7" onclick="window.setQuickPlayLevel(7)" style="
              padding: 10px 8px;
              border: 2px solid #666;
              background: #333;
              color: white;
              border-radius: 6px;
              cursor: pointer;
              font-size: 12px;
              transition: all 0.2s;
              text-align: left;
            "><span style="color: #ec4899;">‚óè</span> Olympic Trials</button>
            <button class="level-btn" data-level="8" onclick="window.setQuickPlayLevel(8)" style="
              padding: 10px 8px;
              border: 2px solid #666;
              background: #333;
              color: white;
              border-radius: 6px;
              cursor: pointer;
              font-size: 12px;
              transition: all 0.2s;
              text-align: left;
            "><span style="color: #ffd700;">‚óè</span> Olympics</button>
          </div>
          <p id="quickplay-level-description" style="margin: 10px 0 0 0; font-size: 12px; color: #718096;">
            National level - Medium difficulty
          </p>
        </div>

        <!-- Game Length Setting -->
        <div style="margin-bottom: 25px;">
          <label style="display: block; margin-bottom: 10px; font-weight: bold; color: #a0aec0;">
            Game Length
          </label>
          <div style="display: flex; gap: 8px;">
            <button class="ends-btn" data-ends="4" onclick="window.setGameLength(4)" style="
              flex: 1;
              padding: 10px;
              border: 2px solid #666;
              background: #333;
              color: white;
              border-radius: 6px;
              cursor: pointer;
              font-size: 14px;
              transition: all 0.2s;
            ">4 Ends</button>
            <button class="ends-btn active" data-ends="8" onclick="window.setGameLength(8)" style="
              flex: 1;
              padding: 10px;
              border: 2px solid #4ade80;
              background: #2d5a3d;
              color: white;
              border-radius: 6px;
              cursor: pointer;
              font-size: 14px;
              transition: all 0.2s;
            ">8 Ends</button>
            <button class="ends-btn" data-ends="10" onclick="window.setGameLength(10)" style="
              flex: 1;
              padding: 10px;
              border: 2px solid #666;
              background: #333;
              color: white;
              border-radius: 6px;
              cursor: pointer;
              font-size: 14px;
              transition: all 0.2s;
            ">10 Ends</button>
          </div>
          <p id="ends-description" style="margin: 10px 0 0 0; font-size: 12px; color: #718096;">
            Standard game length
          </p>
        </div>

        <!-- Difficulty Setting -->
        <div style="margin-bottom: 25px;">
          <label style="display: block; margin-bottom: 10px; font-weight: bold; color: #a0aec0;">
            Difficulty
          </label>
          <div style="display: flex; gap: 8px;">
            <button class="difficulty-btn" data-difficulty="easy" onclick="window.setDifficulty('easy')" style="
              flex: 1;
              padding: 10px;
              border: 2px solid #666;
              background: #333;
              color: white;
              border-radius: 6px;
              cursor: pointer;
              font-size: 14px;
              transition: all 0.2s;
            ">Easy</button>
            <button class="difficulty-btn active" data-difficulty="medium" onclick="window.setDifficulty('medium')" style="
              flex: 1;
              padding: 10px;
              border: 2px solid #4ade80;
              background: #2d5a3d;
              color: white;
              border-radius: 6px;
              cursor: pointer;
              font-size: 14px;
              transition: all 0.2s;
            ">Medium</button>
            <button class="difficulty-btn" data-difficulty="hard" onclick="window.setDifficulty('hard')" style="
              flex: 1;
              padding: 10px;
              border: 2px solid #666;
              background: #333;
              color: white;
              border-radius: 6px;
              cursor: pointer;
              font-size: 14px;
              transition: all 0.2s;
            ">Hard</button>
          </div>
          <p id="difficulty-description" style="margin: 10px 0 0 0; font-size: 12px; color: #718096;">
            Computer makes occasional mistakes
          </p>
        </div>

        <!-- Sound Setting -->
        <div style="margin-bottom: 25px;">
          <label style="display: flex; align-items: center; gap: 12px; cursor: pointer;">
            <input type="checkbox" id="sound-toggle" onchange="window.toggleSound(this.checked)" style="
              width: 20px;
              height: 20px;
              cursor: pointer;
            ">
            <span style="font-weight: bold; color: #a0aec0;">Sound Effects</span>
          </label>
          <p style="margin: 8px 0 0 28px; font-size: 12px; color: #718096;">
            Stone sliding, collisions, sweeping, and more
          </p>
        </div>

        <!-- Career Progress -->
        <div style="margin-bottom: 25px;">
          <div style="font-weight: bold; color: #a0aec0; margin-bottom: 10px;">Career Progress</div>
          <div style="background: rgba(0,0,0,0.3); padding: 12px; border-radius: 8px;">
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px;">
              <div>
                <span style="font-size: 12px; color: #64748b;">Current Level:</span>
                <span id="settings-career-level" style="font-weight: bold; margin-left: 8px;">Club</span>
                <span id="settings-career-difficulty" style="font-size: 12px; color: #94a3b8;">(Beginner)</span>
              </div>
              <span id="settings-career-progress" style="font-size: 12px; color: #64748b;">0/2 wins</span>
            </div>
            <div style="display: flex; gap: 4px; margin-bottom: 10px;">
              <div class="level-pip" data-level="1" style="flex:1;height:6px;background:#6b7280;border-radius:3px;"></div>
              <div class="level-pip" data-level="2" style="flex:1;height:6px;background:#333;border-radius:3px;"></div>
              <div class="level-pip" data-level="3" style="flex:1;height:6px;background:#333;border-radius:3px;"></div>
              <div class="level-pip" data-level="4" style="flex:1;height:6px;background:#333;border-radius:3px;"></div>
              <div class="level-pip" data-level="5" style="flex:1;height:6px;background:#333;border-radius:3px;"></div>
              <div class="level-pip" data-level="6" style="flex:1;height:6px;background:#333;border-radius:3px;"></div>
              <div class="level-pip" data-level="7" style="flex:1;height:6px;background:#333;border-radius:3px;"></div>
              <div class="level-pip" data-level="8" style="flex:1;height:6px;background:#333;border-radius:3px;"></div>
            </div>
            <button onclick="window.showResetConfirm()" style="
              width: 100%;
              padding: 8px;
              background: rgba(239, 68, 68, 0.2);
              border: 1px solid #ef4444;
              border-radius: 4px;
              color: #fca5a5;
              font-size: 12px;
              cursor: pointer;
            ">Reset Career</button>
          </div>
        </div>

        <!-- Country Selection (Coming Soon) -->
        <div style="margin-bottom: 25px;">
          <label style="display: block; margin-bottom: 10px; font-weight: bold; color: #a0aec0;">
            Your Country
          </label>
          <button disabled style="
            width: 100%;
            padding: 12px;
            border: 2px solid #444;
            background: #252525;
            color: #666;
            border-radius: 6px;
            cursor: not-allowed;
            font-size: 14px;
            text-align: left;
            opacity: 0.7;
          ">
            <div style="display: flex; justify-content: space-between; align-items: center;">
              <div style="display: flex; align-items: center; gap: 10px;">
                <span style="font-size: 24px;">üè≥Ô∏è</span>
                <span style="font-weight: bold;">Select Country</span>
              </div>
              <span style="font-size: 10px; background: #4a5568; color: #a0aec0; padding: 2px 8px; border-radius: 10px;">COMING SOON</span>
            </div>
            <div style="font-size: 11px; color: #555; margin-top: 4px;">Represent your nation at International level and above</div>
          </button>
          <div style="margin-top: 8px; display: flex; gap: 6px; flex-wrap: wrap; opacity: 0.5;">
            <span style="font-size: 20px;" title="Canada">üá®üá¶</span>
            <span style="font-size: 20px;" title="Sweden">üá∏üá™</span>
            <span style="font-size: 20px;" title="Switzerland">üá®üá≠</span>
            <span style="font-size: 20px;" title="Norway">üá≥üá¥</span>
            <span style="font-size: 20px;" title="USA">üá∫üá∏</span>
            <span style="font-size: 20px;" title="Japan">üáØüáµ</span>
            <span style="font-size: 20px;" title="South Korea">üá∞üá∑</span>
            <span style="font-size: 20px;" title="Great Britain">üá¨üáß</span>
            <span style="font-size: 20px;" title="Scotland">üè¥Û†ÅßÛ†Å¢Û†Å≥Û†Å£Û†Å¥Û†Åø</span>
            <span style="font-size: 12px; color: #555; align-self: center;">+ more</span>
          </div>
        </div>

        <!-- How to Play -->
        <div style="margin-bottom: 25px;">
          <div style="font-weight: bold; color: #a0aec0; margin-bottom: 10px;">How to Play</div>
          <div style="font-size: 13px; color: #94a3b8; line-height: 1.6; background: rgba(0,0,0,0.3); padding: 12px; border-radius: 8px;">
            <strong style="color: #4ade80;">Throwing:</strong><br>
            1. Set curl direction (IN/OUT buttons)<br>
            2. Click and drag DOWN to set effort<br>
            3. Move LEFT/RIGHT to aim<br>
            4. Release to push off from hack<br>
            5. Click to release the stone<br>
            6. Swipe back and forth to sweep<br>
            <br>
            <strong style="color: #fbbf24;">Split Times (T-line to Hog):</strong><br>
            <span style="color:#34d399">4.3-4.8s Guard</span> |
            <span style="color:#fbbf24">3.6-4.2s Draw</span><br>
            <span style="color:#f97316">2.9-3.5s Takeout</span> |
            <span style="color:#ef4444">2.2-2.8s Peel</span>
          </div>
        </div>

        <!-- Feedback -->
        <div style="margin-bottom: 25px;">
          <div style="font-weight: bold; color: #a0aec0; margin-bottom: 10px;">Feedback</div>
          <div style="display: flex; gap: 10px;">
            <button onclick="window.submitFeedback('bug')" style="
              flex: 1;
              padding: 10px;
              border: 2px solid #ef4444;
              background: rgba(239, 68, 68, 0.2);
              color: #fca5a5;
              border-radius: 6px;
              cursor: pointer;
              font-size: 13px;
              transition: all 0.2s;
            ">Report Bug</button>
            <button onclick="window.submitFeedback('feature')" style="
              flex: 1;
              padding: 10px;
              border: 2px solid #3b82f6;
              background: rgba(59, 130, 246, 0.2);
              color: #93c5fd;
              border-radius: 6px;
              cursor: pointer;
              font-size: 13px;
              transition: all 0.2s;
            ">Request Feature</button>
          </div>
          <p style="margin: 10px 0 0 0; font-size: 11px; color: #718096; text-align: center;">
            Opens email with pre-filled subject
          </p>
        </div>

        <!-- Learn Mode Section -->
        <div style="margin-bottom: 20px;">
          <h3 style="margin: 0 0 12px 0; font-size: 14px; color: #94a3b8; text-transform: uppercase; letter-spacing: 1px;">Learn Mode</h3>
          <button id="reset-tutorials-btn" onclick="window.resetTutorials(); window.closeSettings(); this.textContent='Done!'; this.style.background='rgba(74, 222, 128, 0.3)'; this.style.borderColor='#4ade80';" style="
            width: 100%;
            padding: 10px;
            border: 2px solid #3b82f6;
            background: rgba(96, 165, 250, 0.2);
            color: #93c5fd;
            border-radius: 6px;
            cursor: pointer;
            font-size: 13px;
            transition: all 0.2s;
          ">Reset Tutorials & Restart Game</button>
          <p style="margin: 8px 0 0 0; font-size: 11px; color: #718096;">
            Restarts in Learn Mode (Beginner) with all tutorials
          </p>
        </div>

        <!-- Help & FAQ -->
        <div style="margin-bottom: 20px;">
          <h3 style="margin: 0 0 12px 0; font-size: 14px; color: #94a3b8; text-transform: uppercase; letter-spacing: 1px;">Help</h3>
          <button onclick="window.showFAQ()" style="
            width: 100%;
            padding: 14px 16px;
            border: 2px solid #6366f1;
            background: rgba(99, 102, 241, 0.15);
            color: #a5b4fc;
            border-radius: 8px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 500;
            transition: all 0.2s;
            display: flex;
            align-items: center;
            justify-content: space-between;
          ">
            <span style="display: flex; align-items: center; gap: 10px;">
              <span style="font-size: 18px;">‚ùì</span>
              <span>FAQ & How to Play</span>
            </span>
            <span style="color: #6366f1;">‚Üí</span>
          </button>
        </div>

        <!-- About Button -->
        <div style="margin-bottom: 15px;">
          <button onclick="window.showAbout()" style="
            width: 100%;
            padding: 12px;
            border: 2px solid #8b5cf6;
            background: rgba(139, 92, 246, 0.15);
            color: #c4b5fd;
            border-radius: 8px;
            cursor: pointer;
            font-size: 14px;
            transition: all 0.2s;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
          ">
            <span style="font-size: 18px;">ü•å</span>
            <span>About Curling Pro</span>
          </button>
        </div>

        <!-- Legal Links -->
        <div style="margin-bottom: 20px; display: flex; gap: 10px;">
          <button onclick="window.showPrivacyPolicy()" style="
            flex: 1;
            padding: 10px;
            border: 1px solid #4a5568;
            background: rgba(74, 85, 104, 0.2);
            color: #94a3b8;
            border-radius: 6px;
            cursor: pointer;
            font-size: 13px;
            transition: all 0.2s;
          ">Privacy Policy</button>
          <button onclick="window.showTermsOfService()" style="
            flex: 1;
            padding: 10px;
            border: 1px solid #4a5568;
            background: rgba(74, 85, 104, 0.2);
            color: #94a3b8;
            border-radius: 6px;
            cursor: pointer;
            font-size: 13px;
            transition: all 0.2s;
          ">Terms of Service</button>
        </div>

        <!-- Close Button -->
        <button onclick="window.closeSettings()" style="
          width: 100%;
          padding: 12px;
          background: linear-gradient(135deg, #4a5568 0%, #2d3748 100%);
          border: none;
          border-radius: 8px;
          color: white;
          font-size: 16px;
          font-weight: bold;
          cursor: pointer;
          transition: all 0.2s;
        ">Done</button>
      </div>
    </div>

    <!-- FAQ Screen -->
    <div id="faq-screen" style="
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: linear-gradient(135deg, #0d1117 0%, #1a1a2e 50%, #16213e 100%);
      z-index: 9100;
      overflow-y: auto;
    ">
      <div style="
        max-width: 600px;
        margin: 0 auto;
        padding: 40px 20px max(100px, calc(40px + env(safe-area-inset-bottom)));
        font-family: 'Segoe UI', system-ui, sans-serif;
      ">
        <!-- Header -->
        <div style="display: flex; align-items: center; gap: 16px; margin-bottom: 32px;">
          <button onclick="window.closeFAQ()" style="
            background: rgba(255, 255, 255, 0.1);
            border: none;
            border-radius: 8px;
            color: white;
            font-size: 20px;
            padding: 8px 12px;
            cursor: pointer;
          ">‚Üê</button>
          <h1 style="color: white; font-size: 28px; margin: 0;">FAQ</h1>
        </div>

        <!-- Category List (shown first) -->
        <div id="faq-categories" style="display: block;">
          <!-- Categories populated dynamically -->
        </div>

        <!-- Question List (shown when category selected) -->
        <div id="faq-questions" style="display: none;">
          <button onclick="window.showFAQCategories()" style="
            background: none;
            border: none;
            color: #94a3b8;
            font-size: 14px;
            padding: 0;
            margin-bottom: 20px;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 8px;
          ">‚Üê All Categories</button>
          <h2 id="faq-category-title" style="color: white; font-size: 22px; margin: 0 0 20px 0;"></h2>
          <div id="faq-question-list">
            <!-- Questions populated dynamically -->
          </div>
        </div>
      </div>
    </div>

    <style>
      .faq-category-card {
        background: rgba(255, 255, 255, 0.05);
        border: 2px solid rgba(255, 255, 255, 0.1);
        border-radius: 12px;
        padding: 20px;
        margin-bottom: 12px;
        cursor: pointer;
        transition: all 0.2s;
        display: flex;
        align-items: center;
        gap: 16px;
      }
      .faq-category-card:hover {
        background: rgba(255, 255, 255, 0.08);
        border-color: rgba(255, 255, 255, 0.2);
      }
      .faq-category-card:active {
        transform: scale(0.98);
      }
      .faq-category-icon {
        font-size: 32px;
        width: 48px;
        height: 48px;
        display: flex;
        align-items: center;
        justify-content: center;
        background: rgba(255, 255, 255, 0.1);
        border-radius: 10px;
      }
      .faq-category-info {
        flex: 1;
      }
      .faq-category-name {
        color: white;
        font-size: 16px;
        font-weight: bold;
        margin-bottom: 4px;
      }
      .faq-category-count {
        color: #64748b;
        font-size: 13px;
      }
      .faq-category-arrow {
        color: #64748b;
        font-size: 18px;
      }

      .faq-question-item {
        background: rgba(255, 255, 255, 0.05);
        border: 1px solid rgba(255, 255, 255, 0.1);
        border-radius: 10px;
        margin-bottom: 10px;
        overflow: hidden;
      }
      .faq-question-header {
        padding: 16px;
        cursor: pointer;
        display: flex;
        justify-content: space-between;
        align-items: center;
        gap: 12px;
      }
      .faq-question-header:hover {
        background: rgba(255, 255, 255, 0.03);
      }
      .faq-question-text {
        color: white;
        font-size: 15px;
        font-weight: 500;
        flex: 1;
      }
      .faq-question-toggle {
        color: #64748b;
        font-size: 18px;
        transition: transform 0.2s;
      }
      .faq-question-item.open .faq-question-toggle {
        transform: rotate(180deg);
      }
      .faq-answer {
        max-height: 0;
        overflow: hidden;
        transition: max-height 0.3s ease-out;
      }
      .faq-question-item.open .faq-answer {
        max-height: 500px;
      }
      .faq-answer-content {
        padding: 0 16px 16px 16px;
        color: #94a3b8;
        font-size: 14px;
        line-height: 1.6;
        border-top: 1px solid rgba(255, 255, 255, 0.1);
        padding-top: 16px;
      }
    </style>

    <!-- Feedback Form Modal -->
    <div id="feedback-overlay" style="
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.85);
      z-index: 3000;
      justify-content: center;
      align-items: center;
    ">
      <div id="feedback-modal" style="
        background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
        border: 3px solid #4a5568;
        border-radius: 16px;
        padding: 30px;
        width: 90%;
        max-width: 450px;
        color: white;
        font-family: 'Segoe UI', system-ui, sans-serif;
        box-shadow: 0 10px 40px rgba(0, 0, 0, 0.5);
      ">
        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
          <h2 id="feedback-title" style="margin: 0; font-size: 22px;">Report Bug</h2>
          <button onclick="window.closeFeedback()" style="
            background: none;
            border: none;
            color: #888;
            font-size: 28px;
            cursor: pointer;
            padding: 0;
            line-height: 1;
          ">&times;</button>
        </div>

        <form id="feedback-form" onsubmit="window.sendFeedback(event)">
          <input type="hidden" id="feedback-type" value="bug">

          <div style="margin-bottom: 15px;">
            <label style="display: block; margin-bottom: 5px; color: #a0aec0; font-size: 14px;">Name (optional)</label>
            <input type="text" id="feedback-name" placeholder="Your name" style="
              width: 100%;
              padding: 10px;
              border: 2px solid #4a5568;
              background: #2d3748;
              color: white;
              border-radius: 6px;
              font-size: 14px;
              box-sizing: border-box;
            ">
          </div>

          <div style="margin-bottom: 15px;">
            <label style="display: block; margin-bottom: 5px; color: #a0aec0; font-size: 14px;">Email (optional, for follow-up)</label>
            <input type="email" id="feedback-email" placeholder="your@email.com" style="
              width: 100%;
              padding: 10px;
              border: 2px solid #4a5568;
              background: #2d3748;
              color: white;
              border-radius: 6px;
              font-size: 14px;
              box-sizing: border-box;
            ">
          </div>

          <div style="margin-bottom: 20px;">
            <label style="display: block; margin-bottom: 5px; color: #a0aec0; font-size: 14px;">Message *</label>
            <textarea id="feedback-message" required placeholder="Describe the issue or feature..." style="
              width: 100%;
              padding: 10px;
              border: 2px solid #4a5568;
              background: #2d3748;
              color: white;
              border-radius: 6px;
              font-size: 14px;
              min-height: 120px;
              resize: vertical;
              box-sizing: border-box;
            "></textarea>
          </div>

          <div style="display: flex; gap: 10px;">
            <button type="button" onclick="window.closeFeedback()" style="
              flex: 1;
              padding: 12px;
              background: #4a5568;
              border: none;
              border-radius: 8px;
              color: white;
              font-size: 14px;
              font-weight: bold;
              cursor: pointer;
            ">Cancel</button>
            <button type="submit" id="feedback-submit" style="
              flex: 1;
              padding: 12px;
              background: linear-gradient(135deg, #4ade80 0%, #22c55e 100%);
              border: none;
              border-radius: 8px;
              color: #000;
              font-size: 14px;
              font-weight: bold;
              cursor: pointer;
            ">Send</button>
          </div>

          <p id="feedback-status" style="margin: 15px 0 0 0; text-align: center; font-size: 14px; display: none;"></p>
        </form>
      </div>
    </div>

    <!-- About Screen -->
    <div id="about-screen" style="
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: linear-gradient(135deg, #0d1117 0%, #1a1a2e 50%, #16213e 100%);
      z-index: 9100;
      overflow-y: auto;
    ">
      <div style="
        max-width: 600px;
        margin: 0 auto;
        padding: 40px 20px;
        font-family: 'Segoe UI', system-ui, sans-serif;
      ">
        <!-- Back button -->
        <button onclick="window.closeAbout()" style="
          display: flex;
          align-items: center;
          gap: 8px;
          background: none;
          border: none;
          color: #60a5fa;
          font-size: 16px;
          cursor: pointer;
          padding: 10px 0;
          margin-bottom: 20px;
        ">
          <span>‚Üê</span> Back
        </button>

        <!-- Hero Section -->
        <div style="text-align: center; margin-bottom: 40px;">
          <div style="font-size: 64px; margin-bottom: 16px;">ü•å</div>
          <h1 style="margin: 0; font-size: 32px; color: white;">Curling Pro</h1>
          <p style="margin: 8px 0 0 0; color: #8b5cf6; font-size: 16px;">The sport of chess on ice, now in your browser</p>
        </div>

        <!-- Welcome Section -->
        <div style="
          background: rgba(139, 92, 246, 0.1);
          border: 1px solid rgba(139, 92, 246, 0.3);
          border-radius: 12px;
          padding: 24px;
          margin-bottom: 24px;
        ">
          <h2 style="margin: 0 0 12px 0; font-size: 20px; color: #c4b5fd;">Welcome to the Sheet!</h2>
          <p style="margin: 0; color: #94a3b8; line-height: 1.6;">
            Whether you're a seasoned curler or have never thrown a stone, Curling Pro is here to bring the
            thrill of this incredible sport to you. We believe curling is one of the most strategic,
            exciting, and surprisingly intense sports out there - and we want to share that with everyone.
          </p>
        </div>

        <!-- Philosophy Section -->
        <div style="
          background: rgba(59, 130, 246, 0.1);
          border: 1px solid rgba(59, 130, 246, 0.3);
          border-radius: 12px;
          padding: 24px;
          margin-bottom: 24px;
        ">
          <h2 style="margin: 0 0 12px 0; font-size: 20px; color: #93c5fd;">Our Philosophy</h2>
          <p style="margin: 0 0 16px 0; color: #94a3b8; line-height: 1.6;">
            <strong style="color: white;">Fun meets education.</strong> We built Curling Pro to be more than just a game -
            it's a way to actually improve your real-life curling. The physics are realistic, the strategies
            work on real ice, and every shot you practice here translates to the rink.
          </p>
          <div style="display: flex; flex-wrap: wrap; gap: 12px;">
            <div style="
              flex: 1;
              min-width: 140px;
              background: rgba(0,0,0,0.2);
              padding: 12px;
              border-radius: 8px;
              text-align: center;
            ">
              <div style="font-size: 24px; margin-bottom: 4px;">üéØ</div>
              <div style="color: #94a3b8; font-size: 13px;">Learn Strategy</div>
            </div>
            <div style="
              flex: 1;
              min-width: 140px;
              background: rgba(0,0,0,0.2);
              padding: 12px;
              border-radius: 8px;
              text-align: center;
            ">
              <div style="font-size: 24px; margin-bottom: 4px;">üßä</div>
              <div style="color: #94a3b8; font-size: 13px;">Realistic Physics</div>
            </div>
            <div style="
              flex: 1;
              min-width: 140px;
              background: rgba(0,0,0,0.2);
              padding: 12px;
              border-radius: 8px;
              text-align: center;
            ">
              <div style="font-size: 24px; margin-bottom: 4px;">üèÜ</div>
              <div style="color: #94a3b8; font-size: 13px;">Compete & Grow</div>
            </div>
          </div>
        </div>

        <!-- Features Section -->
        <div style="
          background: rgba(34, 197, 94, 0.1);
          border: 1px solid rgba(34, 197, 94, 0.3);
          border-radius: 12px;
          padding: 24px;
          margin-bottom: 24px;
        ">
          <h2 style="margin: 0 0 16px 0; font-size: 20px; color: #86efac;">What's Inside</h2>
          <div style="color: #94a3b8; line-height: 1.8;">
            <div style="margin-bottom: 8px;">üéÆ <strong style="color: white;">Career Mode</strong> - Rise from club level to world champion</div>
            <div style="margin-bottom: 8px;">üåê <strong style="color: white;">Online Multiplayer</strong> - Challenge players worldwide with ranked matchmaking</div>
            <div style="margin-bottom: 8px;">üéì <strong style="color: white;">Practice Mode</strong> - Master specific shots and scenarios</div>
            <div style="margin-bottom: 8px;">üìö <strong style="color: white;">Learn Mode</strong> - Tutorials that actually teach you curling</div>
            <div style="margin-bottom: 8px;">üé≠ <strong style="color: white;">Realistic Simulation</strong> - Curl, weight, sweeping - it all matters</div>
            <div>üèüÔ∏è <strong style="color: white;">Crowd Atmosphere</strong> - Feel the excitement of a real arena</div>
          </div>
        </div>

        <!-- Fun Fact Section -->
        <div style="
          background: rgba(251, 191, 36, 0.1);
          border: 1px solid rgba(251, 191, 36, 0.3);
          border-radius: 12px;
          padding: 24px;
          margin-bottom: 24px;
        ">
          <h2 style="margin: 0 0 12px 0; font-size: 20px; color: #fcd34d;">Did You Know?</h2>
          <p style="margin: 0; color: #94a3b8; line-height: 1.6;">
            Curling stones are made from rare granite quarried from just two places in the world:
            Ailsa Craig island in Scotland and the Trefor Granite Quarry in Wales. Each stone weighs
            about 44 pounds (20 kg) and can cost over $600! Good thing these virtual ones are free. ü™®
          </p>
        </div>

        <!-- Call to Action -->
        <div style="text-align: center; padding: 20px 0;">
          <p style="color: #64748b; font-size: 14px; margin: 0 0 16px 0;">
            Now get out there and throw some rocks!
          </p>
          <div style="font-size: 32px; color: #fbbf24;">ü•å Good Curling! ü•å</div>
        </div>

        <!-- Version -->
        <div style="text-align: center; margin-top: 30px; padding-top: 20px; border-top: 1px solid #333;">
          <p style="color: #4a5568; font-size: 12px; margin: 0;">
            Curling Pro v1.1.0 | Made with ‚ù§Ô∏è for curlers everywhere
          </p>
        </div>
      </div>
    </div>

    <!-- Leaderboard Screen -->
    <div id="leaderboard-screen" style="
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: linear-gradient(135deg, #0d1117 0%, #1a1a2e 50%, #16213e 100%);
      z-index: 9100;
      overflow-y: auto;
    ">
      <div style="
        max-width: 700px;
        margin: 0 auto;
        padding: 40px 20px;
        font-family: 'Segoe UI', system-ui, sans-serif;
      ">
        <!-- Back button -->
        <button onclick="window.closeLeaderboard()" style="
          display: flex;
          align-items: center;
          gap: 8px;
          background: none;
          border: none;
          color: #60a5fa;
          font-size: 16px;
          cursor: pointer;
          padding: 10px 0;
          margin-bottom: 20px;
        ">
          <span>‚Üê</span> Back
        </button>

        <!-- Header -->
        <div style="text-align: center; margin-bottom: 30px;">
          <h1 style="margin: 0; font-size: 28px; color: white;">Global Leaderboard</h1>
          <p id="leaderboard-player-rank" style="margin: 8px 0 0 0; color: #fbbf24; font-size: 16px;"></p>
        </div>

        <!-- Leaderboard Table -->
        <div style="
          background: rgba(0, 0, 0, 0.3);
          border-radius: 12px;
          overflow: hidden;
        ">
          <!-- Table Header -->
          <div style="
            display: grid;
            grid-template-columns: 60px 1fr 80px 100px 70px;
            padding: 12px 16px;
            background: rgba(139, 92, 246, 0.2);
            border-bottom: 1px solid rgba(139, 92, 246, 0.3);
            font-weight: bold;
            color: #c4b5fd;
            font-size: 13px;
          ">
            <div>Rank</div>
            <div>Player</div>
            <div style="text-align: center;">ELO</div>
            <div style="text-align: center;">W/L</div>
            <div style="text-align: center;">Win%</div>
          </div>

          <!-- Leaderboard Rows Container -->
          <div id="leaderboard-rows" style="max-height: 400px; overflow-y: auto;">
            <div style="padding: 40px; text-align: center; color: #64748b;">
              Loading...
            </div>
          </div>
        </div>

        <!-- Not Ranked Message -->
        <div id="leaderboard-not-ranked" style="
          display: none;
          margin-top: 20px;
          padding: 16px;
          background: rgba(251, 191, 36, 0.1);
          border: 1px solid rgba(251, 191, 36, 0.3);
          border-radius: 8px;
          text-align: center;
          color: #fbbf24;
        ">
          Play ranked matches to appear on the leaderboard!
        </div>
      </div>
    </div>

    <!-- Statistics Screen -->
    <div id="stats-screen" style="
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: linear-gradient(135deg, #0d1117 0%, #1a1a2e 50%, #16213e 100%);
      z-index: 9100;
      overflow-y: auto;
    ">
      <div style="
        max-width: 600px;
        margin: 0 auto;
        padding: 40px 20px;
        font-family: 'Segoe UI', system-ui, sans-serif;
      ">
        <!-- Back button -->
        <button onclick="window.closeStats()" style="
          display: flex;
          align-items: center;
          gap: 8px;
          background: none;
          border: none;
          color: #60a5fa;
          font-size: 16px;
          cursor: pointer;
          padding: 10px 0;
          margin-bottom: 20px;
        ">
          <span>‚Üê</span> Back
        </button>

        <!-- Header -->
        <div style="text-align: center; margin-bottom: 30px;">
          <h1 style="margin: 0; font-size: 28px; color: white;">Your Statistics</h1>
        </div>

        <!-- Tabs -->
        <div style="display: flex; gap: 8px; margin-bottom: 20px;">
          <button id="stats-tab-ranked" onclick="window.showStatsTab('ranked')" style="
            flex: 1;
            padding: 12px;
            background: rgba(139, 92, 246, 0.3);
            border: 1px solid #8b5cf6;
            border-radius: 8px;
            color: white;
            font-size: 14px;
            font-weight: bold;
            cursor: pointer;
          ">Ranked</button>
          <button id="stats-tab-career" onclick="window.showStatsTab('career')" style="
            flex: 1;
            padding: 12px;
            background: rgba(59, 130, 246, 0.1);
            border: 1px solid rgba(59, 130, 246, 0.3);
            border-radius: 8px;
            color: #94a3b8;
            font-size: 14px;
            font-weight: bold;
            cursor: pointer;
          ">Career</button>
        </div>

        <!-- Ranked Stats Panel -->
        <div id="stats-panel-ranked" style="display: block;">
          <!-- ELO Card -->
          <div style="
            background: linear-gradient(135deg, rgba(139, 92, 246, 0.2) 0%, rgba(59, 130, 246, 0.2) 100%);
            border: 1px solid rgba(139, 92, 246, 0.4);
            border-radius: 12px;
            padding: 24px;
            text-align: center;
            margin-bottom: 16px;
          ">
            <div style="color: #c4b5fd; font-size: 14px; margin-bottom: 8px;">Current Rating</div>
            <div id="stats-elo" style="font-size: 48px; font-weight: bold; color: #fbbf24;">--</div>
            <div id="stats-rank" style="color: #94a3b8; font-size: 14px; margin-top: 4px;">Rank: --</div>
          </div>

          <!-- Stats Grid -->
          <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 12px; margin-bottom: 20px;">
            <div style="
              background: rgba(0, 0, 0, 0.3);
              border-radius: 8px;
              padding: 16px;
              text-align: center;
            ">
              <div id="stats-ranked-games" style="font-size: 28px; font-weight: bold; color: white;">0</div>
              <div style="color: #64748b; font-size: 12px;">Games</div>
            </div>
            <div style="
              background: rgba(0, 0, 0, 0.3);
              border-radius: 8px;
              padding: 16px;
              text-align: center;
            ">
              <div id="stats-ranked-wins" style="font-size: 28px; font-weight: bold; color: #4ade80;">0</div>
              <div style="color: #64748b; font-size: 12px;">Wins</div>
            </div>
            <div style="
              background: rgba(0, 0, 0, 0.3);
              border-radius: 8px;
              padding: 16px;
              text-align: center;
            ">
              <div id="stats-ranked-winrate" style="font-size: 28px; font-weight: bold; color: #60a5fa;">0%</div>
              <div style="color: #64748b; font-size: 12px;">Win Rate</div>
            </div>
          </div>
        </div>

        <!-- Career Stats Panel -->
        <div id="stats-panel-career" style="display: none;">
          <!-- Level Card -->
          <div style="
            background: linear-gradient(135deg, rgba(59, 130, 246, 0.2) 0%, rgba(34, 197, 94, 0.2) 100%);
            border: 1px solid rgba(59, 130, 246, 0.4);
            border-radius: 12px;
            padding: 24px;
            text-align: center;
            margin-bottom: 16px;
          ">
            <div style="color: #93c5fd; font-size: 14px; margin-bottom: 8px;">Current Level</div>
            <div id="stats-career-level" style="font-size: 32px; font-weight: bold; color: white;">Club</div>
            <div id="stats-career-progress" style="color: #94a3b8; font-size: 14px; margin-top: 4px;">0/3 wins to advance</div>
          </div>

          <!-- Stats Grid -->
          <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 12px; margin-bottom: 20px;">
            <div style="
              background: rgba(0, 0, 0, 0.3);
              border-radius: 8px;
              padding: 16px;
              text-align: center;
            ">
              <div id="stats-career-games" style="font-size: 28px; font-weight: bold; color: white;">0</div>
              <div style="color: #64748b; font-size: 12px;">Games</div>
            </div>
            <div style="
              background: rgba(0, 0, 0, 0.3);
              border-radius: 8px;
              padding: 16px;
              text-align: center;
            ">
              <div id="stats-career-wins" style="font-size: 28px; font-weight: bold; color: #4ade80;">0</div>
              <div style="color: #64748b; font-size: 12px;">Wins</div>
            </div>
            <div style="
              background: rgba(0, 0, 0, 0.3);
              border-radius: 8px;
              padding: 16px;
              text-align: center;
            ">
              <div id="stats-career-winrate" style="font-size: 28px; font-weight: bold; color: #60a5fa;">0%</div>
              <div style="color: #64748b; font-size: 12px;">Win Rate</div>
            </div>
          </div>
        </div>

        <!-- Recent Matches -->
        <div style="margin-top: 24px;">
          <h3 style="margin: 0 0 12px 0; color: white; font-size: 18px;">Recent Matches</h3>
          <div id="stats-match-history" style="
            background: rgba(0, 0, 0, 0.3);
            border-radius: 8px;
            max-height: 300px;
            overflow-y: auto;
          ">
            <div style="padding: 20px; text-align: center; color: #64748b;">
              No matches yet
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Privacy Policy Modal -->
    <div id="privacy-overlay" onclick="if(event.target === this) window.closePrivacyPolicy()" style="
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.85);
      z-index: 9500;
      justify-content: center;
      align-items: center;
      cursor: pointer;
    ">
      <div id="privacy-modal" onclick="event.stopPropagation()" style="
        background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
        border: 3px solid #4a5568;
        border-radius: 16px;
        padding: 30px;
        width: 90%;
        max-width: 500px;
        max-height: 80vh;
        overflow-y: auto;
        font-family: 'Segoe UI', system-ui, sans-serif;
        cursor: default;
      ">
        <h2 style="color: white; margin: 0 0 20px 0; font-size: 22px; text-align: center;">Privacy Policy</h2>

        <div style="color: #cbd5e1; font-size: 14px; line-height: 1.7;">
          <p style="margin: 0 0 15px 0;"><strong style="color: #4ade80;">Last updated:</strong> January 2026</p>

          <h3 style="color: #94a3b8; font-size: 16px; margin: 20px 0 10px 0;">Data We Collect</h3>
          <p style="margin: 0 0 15px 0;">
            This game stores data <strong>only on your device</strong> using local storage. This includes:
          </p>
          <ul style="margin: 0 0 15px 0; padding-left: 20px;">
            <li>Career progress (level, wins, losses)</li>
            <li>Game settings (sound, difficulty preferences)</li>
            <li>Tutorial completion status</li>
          </ul>

          <h3 style="color: #94a3b8; font-size: 16px; margin: 20px 0 10px 0;">Data We Don't Collect</h3>
          <ul style="margin: 0 0 15px 0; padding-left: 20px;">
            <li>No personal information</li>
            <li>No analytics or tracking</li>
            <li>No cookies</li>
            <li>No data sent to any server</li>
          </ul>

          <h3 style="color: #94a3b8; font-size: 16px; margin: 20px 0 10px 0;">Your Control</h3>
          <p style="margin: 0 0 15px 0;">
            You can clear all stored data at any time by:
          </p>
          <ul style="margin: 0 0 15px 0; padding-left: 20px;">
            <li>Using "Reset Career" in Settings</li>
            <li>Uninstalling the app or clearing app data</li>
          </ul>

          <h3 style="color: #94a3b8; font-size: 16px; margin: 20px 0 10px 0;">Third Parties</h3>
          <p style="margin: 0 0 15px 0;">
            This game does not share any data with third parties. All game logic runs entirely on your device.
          </p>

          <h3 style="color: #94a3b8; font-size: 16px; margin: 20px 0 10px 0;">Contact</h3>
          <p style="margin: 0;">
            If you have questions about this privacy policy, contact us at <a href="mailto:jonathan@pksols.com" style="color: #60a5fa;">jonathan@pksols.com</a>
          </p>
        </div>

        <button onclick="window.closePrivacyPolicy()" style="
          width: 100%;
          margin-top: 25px;
          padding: 12px;
          background: linear-gradient(135deg, #4a5568 0%, #2d3748 100%);
          border: none;
          border-radius: 8px;
          color: white;
          font-size: 16px;
          font-weight: bold;
          cursor: pointer;
        ">Close</button>
      </div>
    </div>

    <!-- Terms of Service Overlay -->
    <div id="tos-overlay" onclick="window.closeTermsOfService()" style="
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.9);
      z-index: 9500;
      justify-content: center;
      align-items: center;
      cursor: pointer;
      padding: max(20px, env(safe-area-inset-top)) max(20px, env(safe-area-inset-right)) max(20px, env(safe-area-inset-bottom)) max(20px, env(safe-area-inset-left));
      box-sizing: border-box;
    ">
      <div id="tos-modal" onclick="event.stopPropagation()" style="
        background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
        border: 3px solid #4a5568;
        border-radius: 16px;
        padding: 30px;
        width: 90%;
        max-width: 600px;
        max-height: 80vh;
        overflow-y: auto;
        font-family: 'Segoe UI', system-ui, sans-serif;
        cursor: default;
      ">
        <h2 style="color: white; margin: 0 0 20px 0; font-size: 22px; text-align: center;">Terms of Service</h2>

        <div style="color: #cbd5e1; font-size: 14px; line-height: 1.7;">
          <p style="margin: 0 0 15px 0;"><strong style="color: #4ade80;">Last updated:</strong> January 2026</p>

          <h3 style="color: #94a3b8; font-size: 16px; margin: 20px 0 10px 0;">1. Acceptance of Terms</h3>
          <p style="margin: 0 0 15px 0;">
            By downloading, installing, or using Curling Coach ("the App"), you agree to these Terms of Service. If you do not agree, please do not use the App.
          </p>

          <h3 style="color: #94a3b8; font-size: 16px; margin: 20px 0 10px 0;">2. Description of Service</h3>
          <p style="margin: 0 0 15px 0;">
            Curling Coach is a free mobile game that simulates the sport of curling. The App includes single-player gameplay against computer opponents of varying difficulty levels.
          </p>

          <h3 style="color: #94a3b8; font-size: 16px; margin: 20px 0 10px 0;">3. License Grant</h3>
          <p style="margin: 0 0 15px 0;">
            We grant you a limited, non-exclusive, non-transferable, revocable license to use the App for personal, non-commercial purposes.
          </p>

          <h3 style="color: #94a3b8; font-size: 16px; margin: 20px 0 10px 0;">4. User Conduct</h3>
          <p style="margin: 0 0 10px 0;">You agree not to:</p>
          <ul style="margin: 0 0 15px 0; padding-left: 20px;">
            <li>Modify, reverse engineer, or decompile the App</li>
            <li>Use the App for any unlawful purpose</li>
            <li>Attempt to gain unauthorized access to any part of the App</li>
            <li>Remove or alter any proprietary notices or labels</li>
          </ul>

          <h3 style="color: #94a3b8; font-size: 16px; margin: 20px 0 10px 0;">5. Intellectual Property</h3>
          <p style="margin: 0 0 15px 0;">
            All content, features, and functionality of the App are owned by the developer and are protected by copyright, trademark, and other intellectual property laws.
          </p>

          <h3 style="color: #94a3b8; font-size: 16px; margin: 20px 0 10px 0;">6. Disclaimer of Warranties</h3>
          <p style="margin: 0 0 15px 0;">
            The App is provided "as is" without warranties of any kind, either express or implied. We do not warrant that the App will be error-free or uninterrupted.
          </p>

          <h3 style="color: #94a3b8; font-size: 16px; margin: 20px 0 10px 0;">7. Limitation of Liability</h3>
          <p style="margin: 0 0 15px 0;">
            To the maximum extent permitted by law, we shall not be liable for any indirect, incidental, special, consequential, or punitive damages arising from your use of the App.
          </p>

          <h3 style="color: #94a3b8; font-size: 16px; margin: 20px 0 10px 0;">8. Changes to Terms</h3>
          <p style="margin: 0 0 15px 0;">
            We reserve the right to modify these terms at any time. Continued use of the App after changes constitutes acceptance of the new terms.
          </p>

          <h3 style="color: #94a3b8; font-size: 16px; margin: 20px 0 10px 0;">9. Termination</h3>
          <p style="margin: 0 0 15px 0;">
            We may terminate or suspend your access to the App at any time, without prior notice, for conduct that we believe violates these Terms or is harmful to other users or the App.
          </p>

          <h3 style="color: #94a3b8; font-size: 16px; margin: 20px 0 10px 0;">10. Contact</h3>
          <p style="margin: 0;">
            If you have questions about these terms, contact us at <a href="mailto:jonathan@pksols.com" style="color: #60a5fa;">jonathan@pksols.com</a>
          </p>
        </div>

        <button onclick="window.closeTermsOfService()" style="
          width: 100%;
          margin-top: 25px;
          padding: 12px;
          background: linear-gradient(135deg, #4a5568 0%, #2d3748 100%);
          border: none;
          border-radius: 8px;
          color: white;
          font-size: 16px;
          font-weight: bold;
          cursor: pointer;
        ">Close</button>
      </div>
    </div>

    <!-- Pause Overlay (iOS interruption handling) -->
    <div id="pause-overlay" onclick="window.resumeFromPause()" style="
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.85);
      z-index: 5000;
      justify-content: center;
      align-items: center;
      flex-direction: column;
      cursor: pointer;
      font-family: 'Segoe UI', system-ui, sans-serif;
      -webkit-tap-highlight-color: transparent;
    ">
      <div style="text-align: center; pointer-events: none;">
        <div style="font-size: 64px; margin-bottom: 20px;">&#9208;</div>
        <h2 style="color: white; margin: 0 0 15px 0; font-size: 32px; font-weight: bold;">PAUSED</h2>
        <p id="pause-message" style="color: #94a3b8; margin: 0 0 30px 0; font-size: 16px;"></p>
        <div style="
          display: inline-block;
          padding: 15px 40px;
          background: linear-gradient(135deg, #3b82f6 0%, #2563eb 100%);
          border-radius: 12px;
          color: white;
          font-size: 18px;
          font-weight: bold;
          animation: pulse-button 2s ease-in-out infinite;
        ">Tap to Continue</div>
      </div>
    </div>
    <style>
      @keyframes pulse-button {
        0%, 100% { transform: scale(1); opacity: 1; }
        50% { transform: scale(1.05); opacity: 0.9; }
      }
    </style>

    <!-- Confirm Modal -->
    <div id="confirm-overlay" style="
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.85);
      z-index: 4000;
      justify-content: center;
      align-items: center;
    ">
      <div id="confirm-modal" style="
        background: linear-gradient(135deg, #1e293b 0%, #0f172a 100%);
        border: 2px solid #ef4444;
        border-radius: 16px;
        padding: 30px;
        width: 90%;
        max-width: 360px;
        text-align: center;
        font-family: 'Segoe UI', system-ui, sans-serif;
        box-shadow: 0 10px 40px rgba(239, 68, 68, 0.2);
      ">
        <div style="font-size: 40px; margin-bottom: 15px;">&#9888;</div>
        <h3 id="confirm-title" style="color: white; margin: 0 0 10px 0; font-size: 20px;">Reset Career?</h3>
        <p id="confirm-message" style="color: #94a3b8; margin: 0 0 25px 0; font-size: 14px; line-height: 1.5;">
          This will reset your progress back to Club level. This action cannot be undone.
        </p>
        <div style="display: flex; gap: 12px;">
          <button onclick="window.hideConfirm()" style="
            flex: 1;
            padding: 12px;
            background: #374151;
            border: none;
            border-radius: 8px;
            color: white;
            font-size: 14px;
            font-weight: bold;
            cursor: pointer;
          ">Cancel</button>
          <button onclick="window.confirmAction()" style="
            flex: 1;
            padding: 12px;
            background: linear-gradient(135deg, #ef4444 0%, #dc2626 100%);
            border: none;
            border-radius: 8px;
            color: white;
            font-size: 14px;
            font-weight: bold;
            cursor: pointer;
          ">Reset</button>
        </div>
      </div>
    </div>

    <!-- Confetti container -->
    <div id="confetti-container"></div>
    <style>
      #confetti-container {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        pointer-events: none;
        z-index: 9999;
        overflow: hidden;
      }
      .confetti {
        position: absolute;
        top: -20px;
        width: 10px;
        height: 10px;
        animation: confetti-fall linear forwards;
      }
      @keyframes confetti-fall {
        0% {
          transform: translateY(0) rotate(0deg);
          opacity: 1;
        }
        100% {
          transform: translateY(100vh) rotate(720deg);
          opacity: 0;
        }
      }
      @keyframes rain-fall {
        0% {
          transform: translateY(0);
          opacity: 0.7;
        }
        100% {
          transform: translateY(100vh);
          opacity: 0.3;
        }
      }
    </style>

    <!-- Post-Shot Feedback Panel (Learn Mode) -->
    <div id="feedback-shot-panel" style="
      display: none;
      position: fixed;
      bottom: calc(100px + env(safe-area-inset-bottom, 0px));
      left: 50%;
      transform: translateX(-50%);
      width: 320px;
      background: linear-gradient(135deg, rgba(30, 41, 59, 0.95) 0%, rgba(15, 23, 42, 0.95) 100%);
      border: 2px solid #3b82f6;
      border-radius: 16px;
      font-family: 'Segoe UI', system-ui, sans-serif;
      color: white;
      box-shadow: 0 10px 40px rgba(0, 0, 0, 0.5);
      z-index: 600;
      padding: 20px;
      text-align: center;
    ">
      <div id="feedback-shot-rating" style="
        font-size: 28px;
        font-weight: bold;
        margin-bottom: 10px;
      ">Good Shot!</div>
      <div id="feedback-shot-result" style="
        font-size: 14px;
        color: #94a3b8;
        margin-bottom: 15px;
        line-height: 1.5;
      ">Your draw came to rest in the 8-foot ring.</div>
      <div id="feedback-shot-tip" style="
        font-size: 13px;
        color: #cbd5e1;
        padding: 10px;
        background: rgba(0, 0, 0, 0.3);
        border-radius: 8px;
        border-left: 3px solid #3b82f6;
        margin-bottom: 15px;
        text-align: left;
        display: none;
      "></div>
      <button onclick="window.dismissShotFeedback()" style="
        padding: 10px 30px;
        background: linear-gradient(135deg, #3b82f6 0%, #2563eb 100%);
        border: none;
        border-radius: 8px;
        color: white;
        font-size: 14px;
        font-weight: bold;
        cursor: pointer;
      ">Continue</button>
    </div>

    <!-- Coach Panel (Learn Mode) -->
    <div id="coach-panel" style="
      display: none;
      position: fixed;
      right: max(20px, env(safe-area-inset-right));
      top: 50%;
      transform: translateY(-50%);
      width: 280px;
      background: linear-gradient(135deg, rgba(30, 41, 59, 0.95) 0%, rgba(15, 23, 42, 0.95) 100%);
      border: 2px solid #4ade80;
      border-radius: 16px;
      font-family: 'Segoe UI', system-ui, sans-serif;
      color: white;
      box-shadow: 0 10px 40px rgba(0, 0, 0, 0.5), 0 0 20px rgba(74, 222, 128, 0.2);
      z-index: 500;
      overflow: hidden;
    ">
      <!-- Header -->
      <div id="coach-header" style="
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 12px 16px;
        background: rgba(74, 222, 128, 0.15);
        border-bottom: 1px solid rgba(74, 222, 128, 0.3);
        cursor: pointer;
      ">
        <div style="display: flex; align-items: center; gap: 8px;" onclick="window.toggleCoachPanel()">
          <span style="font-size: 20px;">üßë‚Äçüè´</span>
          <span style="font-weight: bold; font-size: 14px;">Coach</span>
          <span id="coach-toggle" style="font-size: 12px; color: #94a3b8;">‚ñº</span>
        </div>
        <button onclick="window.dismissCoachSuggestion()" style="
          background: transparent;
          border: none;
          color: #64748b;
          font-size: 18px;
          cursor: pointer;
          padding: 0 4px;
          line-height: 1;
        ">√ó</button>
      </div>

      <!-- Content (collapsible) -->
      <div id="coach-content" style="padding: 16px;">
        <!-- Shot Suggestion -->
        <div id="coach-suggestion" style="margin-bottom: 16px;">
          <div style="font-size: 11px; color: #64748b; text-transform: uppercase; letter-spacing: 1px; margin-bottom: 8px;">
            Suggested Shot
          </div>
          <div id="coach-shot-type" style="
            font-size: 18px;
            font-weight: bold;
            color: #4ade80;
            margin-bottom: 6px;
          ">Draw to Button</div>
          <div id="coach-shot-details" style="font-size: 13px; color: #94a3b8; line-height: 1.5;">
            <div id="coach-weight" style="margin-bottom: 4px;">
              <span style="color: #64748b;">Weight:</span> <span id="coach-weight-value">Draw (55-65%)</span>
            </div>
            <div id="coach-curl" style="margin-bottom: 4px;">
              <span style="color: #64748b;">Curl:</span> <span id="coach-curl-value">IN-turn (clockwise)</span>
            </div>
          </div>
        </div>

        <!-- Reasoning -->
        <div id="coach-reasoning" style="margin-bottom: 16px;">
          <div style="font-size: 11px; color: #64748b; text-transform: uppercase; letter-spacing: 1px; margin-bottom: 8px;">
            Why This Shot?
          </div>
          <div id="coach-reason-text" style="
            font-size: 13px;
            color: #cbd5e1;
            line-height: 1.5;
            padding: 10px;
            background: rgba(0, 0, 0, 0.3);
            border-radius: 8px;
            border-left: 3px solid #4ade80;
          ">
            The house is empty early in the end. Drawing to the button gives us a scoring position and forces the opponent to respond.
          </div>
        </div>

        <!-- Target indicator -->
        <div id="coach-target" style="
          display: flex;
          align-items: center;
          gap: 10px;
          padding: 10px;
          background: rgba(74, 222, 128, 0.1);
          border-radius: 8px;
          margin-bottom: 12px;
        ">
          <span style="font-size: 24px;">üéØ</span>
          <div>
            <div style="font-size: 12px; color: #64748b;">Target shown on ice</div>
            <div id="coach-target-desc" style="font-size: 13px; color: #4ade80;">Button (center of house)</div>
          </div>
        </div>

        <!-- Dismiss button for advanced users -->
        <button id="coach-dismiss" onclick="window.dismissCoachSuggestion()" style="
          width: 100%;
          padding: 8px;
          background: transparent;
          border: 1px solid #4a5568;
          border-radius: 6px;
          color: #64748b;
          font-size: 12px;
          cursor: pointer;
          transition: all 0.2s;
        ">Got it, thanks!</button>
      </div>
    </div>

    <!-- Show Coach button (appears when coach is dismissed) -->
    <button id="show-coach-btn" onclick="window.showCoachPanel()" style="
      display: none;
      position: fixed;
      top: 120px;
      right: max(20px, env(safe-area-inset-right));
      padding: 8px 12px;
      background: rgba(74, 222, 128, 0.2);
      border: 1px solid rgba(74, 222, 128, 0.5);
      border-radius: 8px;
      color: #4ade80;
      font-size: 13px;
      cursor: pointer;
      z-index: 100;
      transition: all 0.2s;
    " title="Show Coach">üßë‚Äçüè´ Coach</button>

    <!-- Tutorial Popup (Learn Mode - Beginner Level) -->
    <div id="tutorial-overlay" style="
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: rgba(0, 0, 0, 0.7);
      z-index: 1000;
      backdrop-filter: blur(3px);
    ">
      <div id="tutorial-popup" style="
        position: absolute;
        left: 50%;
        top: 50%;
        transform: translate(-50%, -50%);
        width: 90%;
        max-width: 520px;
        background: linear-gradient(135deg, rgba(30, 41, 59, 0.98) 0%, rgba(15, 23, 42, 0.98) 100%);
        border: 2px solid #60a5fa;
        border-radius: 16px;
        font-family: 'Segoe UI', system-ui, sans-serif;
        color: white;
        box-shadow: 0 20px 60px rgba(0, 0, 0, 0.6), 0 0 30px rgba(96, 165, 250, 0.3);
        overflow: hidden;
        transition: transform 0.3s ease, opacity 0.3s ease;
      ">
        <!-- Header -->
        <div style="
          display: flex;
          align-items: center;
          gap: 12px;
          padding: 16px 20px;
          background: rgba(96, 165, 250, 0.15);
          border-bottom: 1px solid rgba(96, 165, 250, 0.3);
        ">
          <span id="tutorial-icon" style="font-size: 32px;">üìö</span>
          <div>
            <div id="tutorial-title" style="font-weight: bold; font-size: 18px; color: #60a5fa;">
              Welcome to Curling!
            </div>
            <div id="tutorial-step" style="font-size: 12px; color: #64748b;">Step 1 of 6</div>
          </div>
        </div>

        <!-- Content -->
        <div id="tutorial-content" style="padding: 20px;">
          <p id="tutorial-text" style="
            font-size: 15px;
            line-height: 1.6;
            color: #e2e8f0;
            margin: 0 0 16px 0;
          ">
            Tutorial text goes here...
          </p>

          <!-- Visual hint (optional) -->
          <div id="tutorial-hint" style="
            display: none;
            padding: 12px;
            background: rgba(96, 165, 250, 0.1);
            border-radius: 8px;
            border-left: 3px solid #60a5fa;
            margin-bottom: 16px;
          ">
            <div style="font-size: 12px; color: #60a5fa; margin-bottom: 4px; font-weight: bold;">TIP</div>
            <div id="tutorial-hint-text" style="font-size: 13px; color: #94a3b8;"></div>
          </div>
        </div>

        <!-- Footer -->
        <div style="
          display: flex;
          justify-content: space-between;
          align-items: center;
          padding: 16px 20px;
          background: rgba(0, 0, 0, 0.2);
          border-top: 1px solid rgba(255, 255, 255, 0.1);
        ">
          <label style="display: flex; align-items: center; gap: 8px; font-size: 12px; color: #64748b; cursor: pointer;">
            <input type="checkbox" id="tutorial-dont-show" style="accent-color: #60a5fa;">
            Don't show tutorials again
          </label>
          <button id="tutorial-next-btn" onclick="window.dismissTutorial()" style="
            padding: 10px 24px;
            background: linear-gradient(135deg, #60a5fa 0%, #3b82f6 100%);
            border: none;
            border-radius: 8px;
            color: white;
            font-size: 14px;
            font-weight: bold;
            cursor: pointer;
            box-shadow: 0 4px 15px rgba(96, 165, 250, 0.4);
            transition: all 0.2s;
          ">Got it!</button>
        </div>
      </div>
    </div>

    <!-- Club Selection Screen (Career Mode Start) -->
    <div id="club-select-screen" style="
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: linear-gradient(135deg, #0d1117 0%, #1a1a2e 50%, #16213e 100%);
      z-index: 9000;
      overflow-y: auto;
    ">
      <div style="
        max-width: 500px;
        margin: 0 auto;
        padding: 40px 20px max(100px, calc(40px + env(safe-area-inset-bottom)));
        font-family: 'Segoe UI', system-ui, sans-serif;
      ">
        <button onclick="window.goBackToModeSelect()" style="
          background: none;
          border: none;
          color: #64748b;
          font-size: 14px;
          cursor: pointer;
          margin-bottom: 16px;
        ">‚Üê Back</button>

        <h1 style="color: white; font-size: 28px; margin: 0 0 8px 0;">Start Your Career</h1>
        <p style="color: #94a3b8; font-size: 14px; margin: 0 0 24px 0;">
          Choose your home club. You'll represent them in local and regional events as you work your way up.
        </p>

        <!-- Club Selection Grid -->
        <div id="club-grid" style="
          display: grid;
          grid-template-columns: repeat(2, 1fr);
          gap: 12px;
          margin-bottom: 24px;
        ">
          <!-- Club cards populated dynamically -->
        </div>

        <!-- Custom Club Name (shown when Custom selected) -->
        <div id="custom-club-section" style="display: none; margin-bottom: 24px;">
          <label style="color: #94a3b8; font-size: 12px; display: block; margin-bottom: 8px;">Club Name</label>
          <input type="text" id="custom-club-name" placeholder="Enter club name..." maxlength="24" style="
            width: 100%;
            padding: 12px 16px;
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 8px;
            color: white;
            font-size: 16px;
            box-sizing: border-box;
          ">

          <!-- Custom Crest Selection -->
          <label style="color: #94a3b8; font-size: 12px; display: block; margin: 16px 0 8px 0;">Club Crest</label>

          <!-- Current Crest Preview -->
          <div style="display: flex; align-items: center; gap: 12px; margin-bottom: 12px;">
            <div id="custom-crest-preview" style="
              width: 60px;
              height: 60px;
              background: rgba(255, 255, 255, 0.1);
              border: 2px solid #4ade80;
              border-radius: 12px;
              display: flex;
              align-items: center;
              justify-content: center;
              font-size: 32px;
            ">ü•å</div>
            <div style="flex: 1;">
              <div style="color: white; font-size: 14px; margin-bottom: 4px;">Current Crest</div>
              <div style="color: #64748b; font-size: 12px;">Choose an emoji or upload an image</div>
            </div>
          </div>

          <!-- Emoji Picker -->
          <div id="emoji-crest-grid" style="
            display: grid;
            grid-template-columns: repeat(8, 1fr);
            gap: 6px;
            margin-bottom: 12px;
            padding: 12px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 8px;
          ">
            <!-- Populated by JavaScript -->
          </div>

          <!-- Image Upload -->
          <div style="display: flex; gap: 8px;">
            <label style="
              flex: 1;
              padding: 10px;
              background: rgba(255, 255, 255, 0.05);
              border: 1px dashed rgba(255, 255, 255, 0.3);
              border-radius: 8px;
              color: #94a3b8;
              font-size: 13px;
              text-align: center;
              cursor: pointer;
            ">
              üìÅ Upload Image
              <input type="file" id="custom-crest-upload" accept="image/*" style="display: none;" onchange="window.handleCrestUpload(event)">
            </label>
            <button onclick="window.clearCustomCrest()" style="
              padding: 10px 16px;
              background: rgba(255, 255, 255, 0.05);
              border: 1px solid rgba(255, 255, 255, 0.2);
              border-radius: 8px;
              color: #94a3b8;
              font-size: 13px;
              cursor: pointer;
            ">Reset</button>
          </div>
        </div>

        <!-- Team Name Input -->
        <div style="margin-bottom: 24px;">
          <label style="color: #94a3b8; font-size: 12px; display: block; margin-bottom: 8px;">Team Name</label>
          <input type="text" id="team-name-input" placeholder="Team [Your Name]" maxlength="20" style="
            width: 100%;
            padding: 12px 16px;
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 8px;
            color: white;
            font-size: 16px;
            box-sizing: border-box;
          ">
        </div>

        <!-- Difficulty Selection -->
        <div style="margin-bottom: 24px;">
          <label style="color: #94a3b8; font-size: 12px; display: block; margin-bottom: 12px;">Difficulty</label>
          <div style="display: flex; gap: 8px;">
            <button id="diff-easy" onclick="window.selectCareerDifficulty('easy')" style="
              flex: 1;
              padding: 12px;
              background: rgba(74, 222, 128, 0.2);
              border: 2px solid #4ade80;
              border-radius: 8px;
              color: #4ade80;
              font-size: 14px;
              cursor: pointer;
            ">Easy</button>
            <button id="diff-medium" onclick="window.selectCareerDifficulty('medium')" style="
              flex: 1;
              padding: 12px;
              background: rgba(255, 255, 255, 0.05);
              border: 2px solid rgba(255, 255, 255, 0.2);
              border-radius: 8px;
              color: #94a3b8;
              font-size: 14px;
              cursor: pointer;
            ">Medium</button>
            <button id="diff-hard" onclick="window.selectCareerDifficulty('hard')" style="
              flex: 1;
              padding: 12px;
              background: rgba(255, 255, 255, 0.05);
              border: 2px solid rgba(255, 255, 255, 0.2);
              border-radius: 8px;
              color: #94a3b8;
              font-size: 14px;
              cursor: pointer;
            ">Hard</button>
          </div>
        </div>

        <!-- Start Career Button -->
        <button id="start-career-btn" onclick="window.startNewCareer()" style="
          width: 100%;
          padding: 18px;
          background: linear-gradient(135deg, #4ade80 0%, #22c55e 100%);
          border: none;
          border-radius: 12px;
          color: white;
          font-size: 18px;
          font-weight: bold;
          cursor: pointer;
          box-shadow: 0 4px 20px rgba(74, 222, 128, 0.4);
        ">Start Career</button>
      </div>
    </div>

    <!-- Country Unlock Screen (shown when reaching national tier) -->
    <div id="country-unlock-screen" style="
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: linear-gradient(135deg, #0d1117 0%, #1a1a2e 50%, #16213e 100%);
      z-index: 9500;
      overflow-y: auto;
    ">
      <div style="
        max-width: 500px;
        margin: 0 auto;
        padding: 60px 20px max(100px, calc(40px + env(safe-area-inset-bottom)));
        font-family: 'Segoe UI', system-ui, sans-serif;
        text-align: center;
      ">
        <!-- Celebratory Header -->
        <div style="
          font-size: 48px;
          margin-bottom: 16px;
        ">üèÜ</div>
        <h1 style="color: white; font-size: 28px; margin: 0 0 8px 0;">National Eligibility</h1>
        <p style="color: #94a3b8; font-size: 14px; margin: 0 0 32px 0; line-height: 1.6;">
          Your success at <span id="unlock-club-name" style="color: #4ade80;">your club</span> has earned you the chance to represent your country on the national stage.
        </p>

        <div style="
          background: rgba(251, 191, 36, 0.1);
          border: 1px solid rgba(251, 191, 36, 0.3);
          border-radius: 12px;
          padding: 16px;
          margin-bottom: 24px;
          text-align: left;
        ">
          <div style="color: #fbbf24; font-size: 12px; font-weight: bold; margin-bottom: 8px;">Choose Wisely</div>
          <div style="color: #fde68a; font-size: 13px; line-height: 1.5;">
            This choice is permanent for your career. You'll represent this country in all national and international competitions.
          </div>
        </div>

        <p style="color: #64748b; font-size: 14px; margin-bottom: 16px;">Which country will you represent?</p>

        <!-- Country Selection Grid -->
        <div id="country-unlock-grid" style="
          display: grid;
          grid-template-columns: repeat(2, 1fr);
          gap: 12px;
          margin-bottom: 24px;
        ">
          <!-- Country cards populated dynamically -->
        </div>

        <!-- Confirm Button -->
        <button id="confirm-country-btn" onclick="window.confirmCountrySelection()" style="
          width: 100%;
          padding: 18px;
          background: linear-gradient(135deg, #4ade80 0%, #22c55e 100%);
          border: none;
          border-radius: 12px;
          color: white;
          font-size: 18px;
          font-weight: bold;
          cursor: pointer;
          box-shadow: 0 4px 20px rgba(74, 222, 128, 0.4);
          opacity: 0.5;
          pointer-events: none;
        " disabled>Select a Country</button>
      </div>
    </div>

    <!-- Season Overview Screen (Career Mode Hub) -->
    <div id="season-overview-screen" style="
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: linear-gradient(135deg, #0d1117 0%, #1a1a2e 50%, #16213e 100%);
      z-index: 9000;
      overflow-y: auto;
    ">
      <div style="
        max-width: 500px;
        margin: 0 auto;
        padding: 40px 20px max(100px, calc(40px + env(safe-area-inset-bottom)));
        font-family: 'Segoe UI', system-ui, sans-serif;
      ">
        <!-- Header with Season Info -->
        <div style="
          display: flex;
          justify-content: space-between;
          align-items: flex-start;
          margin-bottom: 24px;
        ">
          <div>
            <div id="season-year" style="color: #64748b; font-size: 14px;">Season 1 ‚Ä¢ 2026</div>
            <h1 style="color: white; font-size: 28px; margin: 4px 0;">Career Mode</h1>
          </div>
          <div id="tier-badge" style="
            padding: 8px 16px;
            background: linear-gradient(135deg, #6b7280, #4b5563);
            border-radius: 20px;
            color: white;
            font-size: 14px;
            font-weight: bold;
            text-transform: uppercase;
          ">Club</div>
        </div>

        <!-- Player Stats Card -->
        <div id="player-stats-card" style="
          background: rgba(255, 255, 255, 0.05);
          border: 1px solid rgba(255, 255, 255, 0.1);
          border-radius: 12px;
          padding: 16px;
          margin-bottom: 20px;
        ">
          <!-- Team/Club Header -->
          <div style="display: flex; align-items: center; gap: 12px; margin-bottom: 12px;">
            <div id="player-club-crest" style="font-size: 28px;">ü•å</div>
            <div style="flex: 1;">
              <div id="player-team-name" style="color: white; font-size: 16px; font-weight: bold;">Team Player</div>
              <div id="player-club-name" style="color: #64748b; font-size: 12px;">Club Name</div>
            </div>
            <div id="player-country-badge" style="display: none; font-size: 24px;"></div>
          </div>
          <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 12px;">
            <span id="player-identity-label" style="color: #94a3b8; font-size: 12px;">Club Level</span>
            <span id="player-ranking" style="color: #fbbf24; font-size: 14px;">Ranking: 1000</span>
          </div>
          <div style="display: flex; gap: 24px;">
            <div>
              <div id="season-wins" style="color: white; font-size: 24px; font-weight: bold;">0</div>
              <div style="color: #64748b; font-size: 12px;">Wins</div>
            </div>
            <div>
              <div id="season-losses" style="color: white; font-size: 24px; font-weight: bold;">0</div>
              <div style="color: #64748b; font-size: 12px;">Losses</div>
            </div>
            <div>
              <div id="season-tournaments" style="color: white; font-size: 24px; font-weight: bold;">0</div>
              <div style="color: #64748b; font-size: 12px;">Trophies</div>
            </div>
          </div>
        </div>

        <!-- Qualifications Section -->
        <div id="qualifications-section" style="
          background: rgba(74, 222, 128, 0.1);
          border: 1px solid rgba(74, 222, 128, 0.3);
          border-radius: 12px;
          padding: 16px;
          margin-bottom: 24px;
          display: none;
        ">
          <div style="color: #4ade80; font-size: 14px; font-weight: bold; margin-bottom: 8px;">Qualifications Earned</div>
          <div id="qualifications-list" style="display: flex; flex-wrap: wrap; gap: 8px;">
            <!-- Qualification badges added dynamically -->
          </div>
        </div>

        <!-- Available Tournaments Section -->
        <div style="margin-bottom: 20px;">
          <h2 style="color: white; font-size: 18px; margin-bottom: 16px;">Available Tournaments</h2>
          <div id="available-tournaments" style="display: flex; flex-direction: column; gap: 12px;">
            <!-- Tournament cards added dynamically -->
          </div>
        </div>

        <!-- Active Tournament Banner (if in tournament) -->
        <div id="active-tournament-banner" style="
          display: none;
          background: linear-gradient(135deg, #1a4d2e 0%, #2d6b40 100%);
          border: 2px solid #4ade80;
          border-radius: 12px;
          padding: 16px;
          margin-bottom: 20px;
          cursor: pointer;
        " onclick="window.showBracket()">
          <div style="display: flex; justify-content: space-between; align-items: center;">
            <div>
              <div style="color: #86efac; font-size: 12px; text-transform: uppercase;">Currently Competing In</div>
              <div id="active-tournament-name" style="color: white; font-size: 18px; font-weight: bold;">Tournament Name</div>
            </div>
            <div style="color: #4ade80; font-size: 24px;">‚Üí</div>
          </div>
        </div>

        <!-- Bottom Actions -->
        <div style="display: flex; gap: 12px; margin-top: 24px;">
          <button onclick="window.goBackToModeSelect()" style="
            flex: 1;
            padding: 14px;
            background: transparent;
            border: 1px solid #64748b;
            border-radius: 8px;
            color: #94a3b8;
            font-size: 14px;
            cursor: pointer;
          ">‚Üê Back</button>
          <button onclick="window.showRestartCareerConfirm()" style="
            flex: 1;
            padding: 14px;
            background: transparent;
            border: 1px solid #ef4444;
            border-radius: 8px;
            color: #f87171;
            font-size: 14px;
            cursor: pointer;
          ">üîÑ Restart Career</button>
          <button onclick="window.startNewSeason()" id="new-season-btn" style="
            flex: 1;
            padding: 14px;
            background: linear-gradient(135deg, #4a5568 0%, #374151 100%);
            border: 1px solid #6b7280;
            border-radius: 8px;
            color: white;
            font-size: 14px;
            cursor: pointer;
            display: none;
          ">Start New Season</button>
        </div>
      </div>

      <!-- Restart Career Confirmation Overlay -->
      <div id="restart-career-confirm" style="
        display: none;
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(0, 0, 0, 0.8);
        z-index: 9500;
        justify-content: center;
        align-items: center;
      ">
        <div style="
          background: #1a1a2e;
          border: 1px solid #ef4444;
          border-radius: 16px;
          padding: 24px;
          max-width: 320px;
          margin: 20px;
          text-align: center;
        ">
          <div style="font-size: 48px; margin-bottom: 16px;">‚ö†Ô∏è</div>
          <h3 style="color: white; margin: 0 0 12px 0; font-size: 20px;">Restart Career?</h3>
          <p style="color: #94a3b8; margin: 0 0 24px 0; font-size: 14px; line-height: 1.5;">
            This will erase all your career progress, including tournaments won, rankings, and qualifications. This cannot be undone.
          </p>
          <div style="display: flex; gap: 12px;">
            <button onclick="window.hideRestartCareerConfirm()" style="
              flex: 1;
              padding: 14px;
              background: transparent;
              border: 1px solid #64748b;
              border-radius: 8px;
              color: #94a3b8;
              font-size: 14px;
              cursor: pointer;
            ">Cancel</button>
            <button onclick="window.confirmRestartCareer()" style="
              flex: 1;
              padding: 14px;
              background: linear-gradient(135deg, #dc2626 0%, #b91c1c 100%);
              border: none;
              border-radius: 8px;
              color: white;
              font-size: 14px;
              font-weight: bold;
              cursor: pointer;
            ">Restart</button>
          </div>
        </div>
      </div>
    </div>

    <!-- Tournament Entry Screen -->
    <div id="tournament-entry-screen" style="
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: linear-gradient(135deg, #0d1117 0%, #1a1a2e 50%, #16213e 100%);
      z-index: 9000;
      overflow-y: auto;
    ">
      <div style="
        max-width: 500px;
        margin: 0 auto;
        padding: 40px 20px max(100px, calc(40px + env(safe-area-inset-bottom)));
        font-family: 'Segoe UI', system-ui, sans-serif;
      ">
        <!-- Header -->
        <button onclick="window.showSeasonOverview()" style="
          background: none;
          border: none;
          color: #64748b;
          font-size: 14px;
          cursor: pointer;
          margin-bottom: 16px;
        ">‚Üê Back to Season</button>

        <!-- Tournament Info Card -->
        <div id="tournament-info-card" style="
          background: rgba(255, 255, 255, 0.05);
          border: 1px solid rgba(255, 255, 255, 0.2);
          border-radius: 16px;
          overflow: hidden;
          margin-bottom: 24px;
        ">
          <!-- Tournament Header -->
          <div id="tournament-header" style="
            padding: 24px;
            background: linear-gradient(135deg, #1a4d2e 0%, #2d6b40 100%);
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
          ">
            <div id="tournament-tier-label" style="
              color: #86efac;
              font-size: 12px;
              text-transform: uppercase;
              letter-spacing: 1px;
              margin-bottom: 8px;
            ">Club Tournament</div>
            <h1 id="tournament-name-display" style="
              color: white;
              font-size: 24px;
              margin: 0 0 8px 0;
            ">Tournament Name</h1>
            <div id="tournament-format" style="color: #a7f3d0; font-size: 14px;">
              Single Elimination ‚Ä¢ 4 Teams
            </div>
          </div>

          <!-- Tournament Details -->
          <div style="padding: 20px;">
            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 16px; margin-bottom: 20px;">
              <div>
                <div style="color: #64748b; font-size: 12px; margin-bottom: 4px;">Reward</div>
                <div id="tournament-reward" style="color: white; font-size: 16px; font-weight: bold;">+25 Points</div>
              </div>
              <div>
                <div style="color: #64748b; font-size: 12px; margin-bottom: 4px;">Qualification</div>
                <div id="tournament-qualification" style="color: #4ade80; font-size: 16px; font-weight: bold;">‚Äî</div>
              </div>
            </div>

            <!-- Requirements (if any) -->
            <div id="tournament-requirements" style="
              display: none;
              padding: 12px;
              background: rgba(251, 191, 36, 0.1);
              border: 1px solid rgba(251, 191, 36, 0.3);
              border-radius: 8px;
              margin-bottom: 16px;
            ">
              <div style="color: #fbbf24; font-size: 12px; font-weight: bold; margin-bottom: 4px;">Entry Requirement</div>
              <div id="tournament-req-text" style="color: #fde68a; font-size: 14px;">Qualification needed</div>
            </div>
          </div>
        </div>

        <!-- Field Preview -->
        <div style="margin-bottom: 24px;">
          <h2 style="color: white; font-size: 16px; margin-bottom: 12px;">Expected Field</h2>
          <div id="tournament-field-preview" style="
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 8px;
          ">
            <!-- Team previews added dynamically -->
          </div>
        </div>

        <!-- Enter Tournament Button -->
        <button id="enter-tournament-btn" style="
          width: 100%;
          padding: 18px;
          background: linear-gradient(135deg, #4ade80 0%, #22c55e 100%);
          border: none;
          border-radius: 12px;
          color: white;
          font-size: 18px;
          font-weight: bold;
          cursor: pointer;
          box-shadow: 0 4px 20px rgba(74, 222, 128, 0.4);
          transition: all 0.2s;
          -webkit-tap-highlight-color: transparent;
          touch-action: manipulation;
          user-select: none;
        ">Enter Tournament</button>

        <!-- Locked State Button (shown when requirements not met) -->
        <button id="tournament-locked-btn" style="
          display: none;
          width: 100%;
          padding: 18px;
          background: #374151;
          border: 1px solid #4b5563;
          border-radius: 12px;
          color: #9ca3af;
          font-size: 16px;
          cursor: not-allowed;
        ">üîí Qualification Required</button>
      </div>
    </div>

    <!-- Bracket Display Screen -->
    <div id="bracket-screen" style="
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: linear-gradient(135deg, #0d1117 0%, #1a1a2e 50%, #16213e 100%);
      z-index: 9000;
      overflow: hidden;
    ">
      <!-- Bracket Header -->
      <div style="
        position: sticky;
        top: 0;
        left: 0;
        right: 0;
        padding: max(16px, env(safe-area-inset-top)) 16px 12px;
        background: rgba(13, 17, 23, 0.95);
        border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        z-index: 10;
      ">
        <div style="max-width: 800px; margin: 0 auto; display: flex; justify-content: space-between; align-items: center;">
          <button onclick="window.showSeasonOverview()" style="
            background: none;
            border: none;
            color: #64748b;
            font-size: 14px;
            cursor: pointer;
            font-family: 'Segoe UI', system-ui, sans-serif;
          ">‚Üê Season</button>
          <div style="text-align: center;">
            <div id="bracket-tournament-name" style="color: white; font-size: 16px; font-weight: bold; font-family: 'Segoe UI', system-ui, sans-serif;">Tournament</div>
            <div id="bracket-phase" style="color: #64748b; font-size: 12px; font-family: 'Segoe UI', system-ui, sans-serif;">Playoffs</div>
          </div>
          <div style="width: 60px;"></div>
        </div>
      </div>

      <!-- Bracket Container (scrollable) -->
      <div id="bracket-container" style="
        width: 100%;
        height: calc(100% - 120px);
        overflow: auto;
        padding: 20px;
        -webkit-overflow-scrolling: touch;
      ">
        <div id="bracket-grid" style="
          display: flex;
          gap: 40px;
          min-width: max-content;
          padding-bottom: 20px;
        ">
          <!-- Bracket rounds added dynamically -->
        </div>
      </div>

      <!-- Bottom Action Bar -->
      <div style="
        position: fixed;
        bottom: 0;
        left: 0;
        right: 0;
        padding: 16px 20px max(20px, env(safe-area-inset-bottom));
        background: rgba(13, 17, 23, 0.98);
        border-top: 1px solid rgba(255, 255, 255, 0.1);
        z-index: 10;
      ">
        <div style="max-width: 500px; margin: 0 auto;">
          <button id="play-next-match-btn" style="
            width: 100%;
            padding: 16px;
            background: linear-gradient(135deg, #4ade80 0%, #22c55e 100%);
            border: none;
            border-radius: 12px;
            color: white;
            font-size: 16px;
            font-weight: bold;
            cursor: pointer;
            box-shadow: 0 4px 20px rgba(74, 222, 128, 0.4);
            font-family: 'Segoe UI', system-ui, sans-serif;
            -webkit-tap-highlight-color: transparent;
            touch-action: manipulation;
          ">Play Next Match</button>
        </div>
      </div>
    </div>

    <!-- Pre-Match Screen -->
    <div id="pre-match-screen" style="
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: linear-gradient(135deg, #0d1117 0%, #1a1a2e 50%, #16213e 100%);
      z-index: 9000;
      overflow-y: auto;
    ">
      <div style="
        max-width: 500px;
        margin: 0 auto;
        padding: 40px 20px max(100px, calc(40px + env(safe-area-inset-bottom)));
        font-family: 'Segoe UI', system-ui, sans-serif;
        text-align: center;
      ">
        <!-- Tournament Context -->
        <div id="match-context" style="
          color: #64748b;
          font-size: 14px;
          margin-bottom: 8px;
        ">Semifinals ‚Ä¢ Club Bonspiel</div>

        <h1 style="color: white; font-size: 24px; margin-bottom: 32px;">Next Match</h1>

        <!-- VS Display -->
        <div style="display: flex; align-items: center; justify-content: center; gap: 24px; margin-bottom: 32px;">
          <!-- Player Card -->
          <div style="
            flex: 1;
            max-width: 150px;
            background: rgba(74, 222, 128, 0.1);
            border: 2px solid #4ade80;
            border-radius: 12px;
            padding: 20px 16px;
          ">
            <div id="player-match-avatar" style="
              width: 60px;
              height: 60px;
              background: linear-gradient(135deg, #4ade80, #22c55e);
              border-radius: 50%;
              margin: 0 auto 12px;
              display: flex;
              align-items: center;
              justify-content: center;
              font-size: 28px;
            ">ü•å</div>
            <div id="player-match-name" style="color: white; font-size: 16px; font-weight: bold;">You</div>
            <div id="player-match-team" style="color: #86efac; font-size: 12px;">Team Player</div>
          </div>

          <!-- VS Badge -->
          <div style="
            color: #64748b;
            font-size: 20px;
            font-weight: bold;
          ">VS</div>

          <!-- Opponent Card -->
          <div id="opponent-card" style="
            flex: 1;
            max-width: 150px;
            background: rgba(239, 68, 68, 0.1);
            border: 2px solid #ef4444;
            border-radius: 12px;
            padding: 20px 16px;
          ">
            <div style="
              width: 60px;
              height: 60px;
              background: linear-gradient(135deg, #ef4444, #dc2626);
              border-radius: 50%;
              margin: 0 auto 12px;
              display: flex;
              align-items: center;
              justify-content: center;
              font-size: 24px;
            ">ü•å</div>
            <div id="opponent-name" style="color: white; font-size: 16px; font-weight: bold;">Opponent</div>
            <div id="opponent-team" style="color: #fca5a5; font-size: 12px;">Team Name</div>
          </div>
        </div>

        <!-- Opponent Info -->
        <div id="opponent-info-card" style="
          background: rgba(255, 255, 255, 0.05);
          border: 1px solid rgba(255, 255, 255, 0.1);
          border-radius: 12px;
          padding: 16px;
          margin-bottom: 24px;
          text-align: left;
        ">
          <div style="display: flex; justify-content: space-between; margin-bottom: 12px;">
            <span style="color: #64748b; font-size: 14px;">Personality</span>
            <span id="opponent-personality-badge" style="
              padding: 4px 12px;
              background: rgba(251, 191, 36, 0.2);
              border-radius: 12px;
              color: #fbbf24;
              font-size: 12px;
            ">Balanced</span>
          </div>
          <div id="opponent-bio" style="color: #94a3b8; font-size: 13px; line-height: 1.5;">
            Opponent bio text...
          </div>

          <!-- Rivalry History (if applicable) -->
          <div id="rivalry-history" style="
            display: none;
            margin-top: 12px;
            padding-top: 12px;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
          ">
            <div style="color: #fbbf24; font-size: 12px; font-weight: bold; margin-bottom: 4px;">üî• Rivalry History</div>
            <div id="rivalry-record" style="color: #fde68a; font-size: 13px;">You: 2 | Them: 1</div>
          </div>
        </div>

        <!-- Start Match Button -->
        <button onclick="window.startTournamentMatch()" style="
          width: 100%;
          padding: 18px;
          background: linear-gradient(135deg, #4ade80 0%, #22c55e 100%);
          border: none;
          border-radius: 12px;
          color: white;
          font-size: 18px;
          font-weight: bold;
          cursor: pointer;
          box-shadow: 0 4px 20px rgba(74, 222, 128, 0.4);
        ">Start Match</button>
      </div>
    </div>

    <!-- Post-Match Screen -->
    <div id="post-match-screen" style="
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: linear-gradient(135deg, #0d1117 0%, #1a1a2e 50%, #16213e 100%);
      z-index: 9000;
      overflow-y: auto;
    ">
      <div style="
        max-width: 500px;
        margin: 0 auto;
        padding: 40px 20px max(100px, calc(40px + env(safe-area-inset-bottom)));
        font-family: 'Segoe UI', system-ui, sans-serif;
        text-align: center;
      ">
        <!-- Result Banner -->
        <div id="match-result-banner" style="
          padding: 24px;
          background: linear-gradient(135deg, #1a4d2e 0%, #2d6b40 100%);
          border-radius: 16px;
          margin-bottom: 24px;
        ">
          <div id="match-result-text" style="
            color: white;
            font-size: 32px;
            font-weight: bold;
            margin-bottom: 8px;
          ">VICTORY!</div>
          <div id="match-final-score" style="
            color: #86efac;
            font-size: 24px;
          ">7 - 4</div>
        </div>

        <!-- Match Summary -->
        <div style="
          background: rgba(255, 255, 255, 0.05);
          border: 1px solid rgba(255, 255, 255, 0.1);
          border-radius: 12px;
          padding: 16px;
          margin-bottom: 24px;
        ">
          <div id="match-opponent-defeated" style="color: #94a3b8; font-size: 14px; margin-bottom: 12px;">
            Defeated John Smith
          </div>
          <div style="display: flex; justify-content: center; gap: 32px;">
            <div>
              <div id="post-match-wins" style="color: white; font-size: 20px; font-weight: bold;">3</div>
              <div style="color: #64748b; font-size: 12px;">Season Wins</div>
            </div>
            <div>
              <div id="post-match-points" style="color: #fbbf24; font-size: 20px; font-weight: bold;">+25</div>
              <div style="color: #64748b; font-size: 12px;">Points Earned</div>
            </div>
          </div>
        </div>

        <!-- Tournament Progress (mini bracket) -->
        <div id="tournament-progress-section" style="margin-bottom: 24px;">
          <div style="color: #64748b; font-size: 14px; margin-bottom: 12px;">Tournament Progress</div>
          <div id="mini-bracket-preview" style="
            background: rgba(255, 255, 255, 0.03);
            border-radius: 12px;
            padding: 16px;
          ">
            <!-- Mini bracket added dynamically -->
          </div>
        </div>

        <!-- Next Action -->
        <div id="post-match-next-info" style="
          color: #94a3b8;
          font-size: 14px;
          margin-bottom: 16px;
        ">Next: Finals vs. Sarah Johnson</div>

        <button id="continue-tournament-btn" onclick="window.continueTournament()" style="
          width: 100%;
          padding: 18px;
          background: linear-gradient(135deg, #4ade80 0%, #22c55e 100%);
          border: none;
          border-radius: 12px;
          color: white;
          font-size: 18px;
          font-weight: bold;
          cursor: pointer;
          box-shadow: 0 4px 20px rgba(74, 222, 128, 0.4);
        ">Continue</button>

        <!-- Return to Season (after tournament ends) -->
        <button id="return-to-season-btn" onclick="window.showSeasonOverview()" style="
          display: none;
          width: 100%;
          padding: 18px;
          margin-top: 12px;
          background: linear-gradient(135deg, #3b82f6 0%, #2563eb 100%);
          border: none;
          border-radius: 12px;
          color: white;
          font-size: 18px;
          font-weight: bold;
          cursor: pointer;
        ">Return to Season</button>
      </div>
    </div>

    <!-- Settings button (upper right) -->
    <button id="settings-btn-top" onclick="window.openSettings()" style="
      position: fixed;
      top: max(20px, env(safe-area-inset-top));
      right: max(20px, env(safe-area-inset-right));
      padding: 10px 14px;
      background: rgba(0, 0, 0, 0.6);
      border: 2px solid #666;
      border-radius: 8px;
      color: white;
      font-size: 20px;
      cursor: pointer;
      z-index: 100;
      transition: all 0.2s;
    " title="Settings">&#9881;</button>
    <script type="module" src="/src/main.js"></script>
  </body>
</html>
